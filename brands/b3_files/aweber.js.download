/*! aweber.js v1.3.0 | (c) AWeber Communications */
!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var n=t((function(t){var n,r;n=e,r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?i(console,r):void 0!==console.log?i(console,"log"):e)}function s(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function u(e,n,r){return function(){typeof console!==t&&(s.call(this,n,r),this[e].apply(this,arguments))}}function c(e,t,n){return a(e)||u.apply(this,arguments)}function l(e,n,i){var o,a=this,u="loglevel";function l(){var e;if(typeof window!==t&&u){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(u)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=i||c,a.getLevel=function(){return o},a.setLevel=function(n,i){if("string"==typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==i&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&u){try{return void(window.localStorage[u]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+n+";"}catch(e){}}}(n),s.call(a,n,e),typeof console===t&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){l()||a.setLevel(e,!1)},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var d=l();null==d&&(d=null==n?"WARN":n),a.setLevel(d,!1)}var d=new l,p={};d.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=p[e];return t||(t=p[e]=new l(e,d.getLevel(),d.methodFactory)),t};var f=typeof window!==t?window.log:void 0;return d.noConflict=function(){return typeof window!==t&&window.log===d&&(window.log=f),d},d.getLoggers=function(){return p},d.default=d,d},t.exports?t.exports=r():n.log=r()}));let r="trace";r="info";const i=n.methodFactory;n.methodFactory=function(e,t,n){const r=i(e,t,n);return(...e)=>{const t=n?`[AW-${n}]:`:"";r.apply(void 0,[t,...e])}},n.setDefaultLevel("info");var o=t((function(t){!function(e){var n=function(e,t,r){if(!u(t)||l(t)||d(t)||p(t)||s(t))return t;var i,o=0,a=0;if(c(t))for(i=[],a=t.length;o<a;o++)i.push(n(e,t[o],r));else for(var f in i={},t)Object.prototype.hasOwnProperty.call(t,f)&&(i[e(f,r)]=n(e,t[f],r));return i},r=function(e){return f(e)?e:(e=e.replace(/[\-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))).substr(0,1).toLowerCase()+e.substr(1)},i=function(e){var t=r(e);return t.substr(0,1).toUpperCase()+t.substr(1)},o=function(e,t){return function(e,t){var n=(t=t||{}).separator||"_",r=t.split||/(?=[A-Z])/;return e.split(r).join(n)}(e,t).toLowerCase()},a=Object.prototype.toString,s=function(e){return"function"==typeof e},u=function(e){return e===Object(e)},c=function(e){return"[object Array]"==a.call(e)},l=function(e){return"[object Date]"==a.call(e)},d=function(e){return"[object RegExp]"==a.call(e)},p=function(e){return"[object Boolean]"==a.call(e)},f=function(e){return(e-=0)==e},h=function(e,t){var n=t&&"process"in t?t.process:t;return"function"!=typeof n?e:function(t,r){return n(t,e,r)}},m={camelize:r,decamelize:o,pascalize:i,depascalize:o,camelizeKeys:function(e,t){return n(h(r,t),e)},decamelizeKeys:function(e,t){return n(h(o,t),e,t)},pascalizeKeys:function(e,t){return n(h(i,t),e)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};t.exports?t.exports=m:e.humps=m}(e)}));function a(e,t={}){const n={cache:"no-cache",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json",Pragma:"no-cache"},...t};return fetch(e,n).then(e=>{const{status:t}=e;return 200===t?e.json().then(e=>({data:o.camelizeKeys(e),status:t})):t<400?Promise.resolve({data:null,status:t}):Promise.reject({data:e.statusText,status:t})})}function s(e){return"https://{account}.optin.com".replace("{account}",e.replace(/-/g,""))}const u=n.getLogger("Storage");function c(){}var l=e=>{if(!e||"string"!=typeof e)throw new Error(`Unable to create localStorage engine. Expected a string but saw ${e}.`);const t=function(){let e,t,n;try{return n="1234567890",(e=window.localStorage).setItem(n,n),t=e.getItem(n)===n,e.removeItem(n),t&&e}catch(e){return!1}}();return t?{load:()=>new Promise(n=>{let r=null;try{const n=t.getItem(e);r="string"==typeof n?JSON.parse(n):n}catch(e){u.error(e)}n(r)}),save:n=>new Promise(r=>{try{const r=JSON.stringify(n);t.setItem(e,r)}catch(e){u.error("There was a problem saving to localStorage",e)}r()}),remove:()=>new Promise(n=>{try{t.removeItem(e)}catch(e){u.error("There was a problem clearing localStorage",e)}n()})}:(u.error("localStorage is unsupported or unavailable"),{load:c,save:c})},d={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},p={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},f=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],h={CSS:{},springs:{}};function m(e,t,n){return Math.min(Math.max(e,t),n)}function v(e,t){return e.indexOf(t)>-1}function g(e,t){return e.apply(null,t)}var y={arr:function(e){return Array.isArray(e)},obj:function(e){return v(Object.prototype.toString.call(e),"Object")},pth:function(e){return y.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return e.nodeType||y.svg(e)},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return void 0===e},nil:function(e){return y.und(e)||null===e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return y.hex(e)||y.rgb(e)||y.hsl(e)},key:function(e){return!d.hasOwnProperty(e)&&!p.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function b(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map((function(e){return parseFloat(e)})):[]}function w(e,t){var n=b(e),r=m(y.und(n[0])?1:n[0],.1,100),i=m(y.und(n[1])?100:n[1],.1,100),o=m(y.und(n[2])?10:n[2],.1,100),a=m(y.und(n[3])?0:n[3],.1,100),s=Math.sqrt(i/r),u=o/(2*Math.sqrt(i*r)),c=u<1?s*Math.sqrt(1-u*u):0,l=u<1?(u*s-a)/c:-a+s;function d(e){var n=t?t*e/1e3:e;return n=u<1?Math.exp(-n*u*s)*(1*Math.cos(c*n)+l*Math.sin(c*n)):(1+l*n)*Math.exp(-n*s),0===e||1===e?e:1-n}return t?d:function(){var t=h.springs[e];if(t)return t;for(var n=1/6,r=0,i=0;;)if(1===d(r+=n)){if(++i>=16)break}else i=0;var o=r*n*1e3;return h.springs[e]=o,o}}function S(e){return void 0===e&&(e=10),function(t){return Math.ceil(m(t,1e-6,1)*e)*(1/e)}}var P,x,k=function(){var e=.1;function t(e,t){return 1-3*t+3*e}function n(e,t){return 3*t-6*e}function r(e){return 3*e}function i(e,i,o){return((t(i,o)*e+n(i,o))*e+r(i))*e}function o(e,i,o){return 3*t(i,o)*e*e+2*n(i,o)*e+r(i)}return function(t,n,r,a){if(0<=t&&t<=1&&0<=r&&r<=1){var s=new Float32Array(11);if(t!==n||r!==a)for(var u=0;u<11;++u)s[u]=i(u*e,t,r);return function(e){return t===n&&r===a||0===e||1===e?e:i(c(e),n,a)}}function c(n){for(var a=0,u=1;10!==u&&s[u]<=n;++u)a+=e;--u;var c=a+(n-s[u])/(s[u+1]-s[u])*e,l=o(c,t,r);return l>=.001?function(e,t,n,r){for(var a=0;a<4;++a){var s=o(t,n,r);if(0===s)return t;t-=(i(t,n,r)-e)/s}return t}(n,c,t,r):0===l?c:function(e,t,n,r,o){var a,s,u=0;do{(a=i(s=t+(n-t)/2,r,o)-e)>0?n=s:t=s}while(Math.abs(a)>1e-7&&++u<10);return s}(n,a,a+e,t,r)}}}(),E=(P={linear:function(){return function(e){return e}}},x={Sine:function(){return function(e){return 1-Math.cos(e*Math.PI/2)}},Circ:function(){return function(e){return 1-Math.sqrt(1-e*e)}},Back:function(){return function(e){return e*e*(3*e-2)}},Bounce:function(){return function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}},Elastic:function(e,t){void 0===e&&(e=1),void 0===t&&(t=.5);var n=m(e,1,10),r=m(t,.1,2);return function(e){return 0===e||1===e?e:-n*Math.pow(2,10*(e-1))*Math.sin((e-1-r/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/r)}}},["Quad","Cubic","Quart","Quint","Expo"].forEach((function(e,t){x[e]=function(){return function(e){return Math.pow(e,t+2)}}})),Object.keys(x).forEach((function(e){var t=x[e];P["easeIn"+e]=t,P["easeOut"+e]=function(e,n){return function(r){return 1-t(e,n)(1-r)}},P["easeInOut"+e]=function(e,n){return function(r){return r<.5?t(e,n)(2*r)/2:1-t(e,n)(-2*r+2)/2}},P["easeOutIn"+e]=function(e,n){return function(r){return r<.5?(1-t(e,n)(1-2*r))/2:(t(e,n)(2*r-1)+1)/2}}})),P);function O(e,t){if(y.fnc(e))return e;var n=e.split("(")[0],r=E[n],i=b(e);switch(n){case"spring":return w(e,t);case"cubicBezier":return g(k,i);case"steps":return g(S,i);default:return g(r,i)}}function T(e){try{return document.querySelectorAll(e)}catch(e){return}}function N(e,t){for(var n=e.length,r=arguments.length>=2?arguments[1]:void 0,i=[],o=0;o<n;o++)if(o in e){var a=e[o];t.call(r,a,o,e)&&i.push(a)}return i}function A(e){return e.reduce((function(e,t){return e.concat(y.arr(t)?A(t):t)}),[])}function C(e){return y.arr(e)?e:(y.str(e)&&(e=T(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function I(e,t){return e.some((function(e){return e===t}))}function D(e){var t={};for(var n in e)t[n]=e[n];return t}function M(e,t){var n=D(e);for(var r in e)n[r]=t.hasOwnProperty(r)?t[r]:e[r];return n}function L(e,t){var n=D(e);for(var r in t)n[r]=y.und(e[r])?t[r]:e[r];return n}function W(e){return y.rgb(e)?(n=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t=e))?"rgba("+n[1]+",1)":t:y.hex(e)?function(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return t+t+n+n+r+r})),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+parseInt(n[1],16)+","+parseInt(n[2],16)+","+parseInt(n[3],16)+",1)"}(e):y.hsl(e)?function(e){var t,n,r,i=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),o=parseInt(i[1],10)/360,a=parseInt(i[2],10)/100,s=parseInt(i[3],10)/100,u=i[4]||1;function c(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(0==a)t=n=r=s;else{var l=s<.5?s*(1+a):s+a-s*a,d=2*s-l;t=c(d,l,o+1/3),n=c(d,l,o),r=c(d,l,o-1/3)}return"rgba("+255*t+","+255*n+","+255*r+","+u+")"}(e):void 0;var t,n}function B(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function F(e,t){return y.fnc(e)?e(t.target,t.id,t.total):e}function j(e,t){return e.getAttribute(t)}function U(e,t,n){if(I([n,"deg","rad","turn"],B(t)))return t;var r=h.CSS[t+n];if(!y.und(r))return r;var i=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(i),i.style.position="absolute",i.style.width=100+n;var a=100/i.offsetWidth;o.removeChild(i);var s=a*parseFloat(t);return h.CSS[t+n]=s,s}function R(e,t,n){if(t in e.style){var r=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i=e.style[t]||getComputedStyle(e).getPropertyValue(r)||"0";return n?U(e,i,n):i}}function z(e,t){return y.dom(e)&&!y.inp(e)&&(!y.nil(j(e,t))||y.svg(e)&&e[t])?"attribute":y.dom(e)&&I(f,t)?"transform":y.dom(e)&&"transform"!==t&&R(e,t)?"css":null!=e[t]?"object":void 0}function q(e){if(y.dom(e)){for(var t,n=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map;t=r.exec(n);)i.set(t[1],t[2]);return i}}function K(e,t,n,r){var i=v(t,"scale")?1:0+function(e){return v(e,"translate")||"perspective"===e?"px":v(e,"rotate")||v(e,"skew")?"deg":void 0}(t),o=q(e).get(t)||i;return n&&(n.transforms.list.set(t,o),n.transforms.last=t),r?U(e,o,r):o}function _(e,t,n,r){switch(z(e,t)){case"transform":return K(e,t,r,n);case"css":return R(e,t,n);case"attribute":return j(e,t);default:return e[t]||0}}function H(e,t){var n=/^(\*=|\+=|-=)/.exec(e);if(!n)return e;var r=B(e)||0,i=parseFloat(t),o=parseFloat(e.replace(n[0],""));switch(n[0][0]){case"+":return i+o+r;case"-":return i-o+r;case"*":return i*o+r}}function $(e,t){if(y.col(e))return W(e);if(/\s/g.test(e))return e;var n=B(e),r=n?e.substr(0,e.length-n.length):e;return t?r+t:r}function V(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function J(e){for(var t,n=e.points,r=0,i=0;i<n.numberOfItems;i++){var o=n.getItem(i);i>0&&(r+=V(t,o)),t=o}return r}function Y(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return function(e){return 2*Math.PI*j(e,"r")}(e);case"rect":return function(e){return 2*j(e,"width")+2*j(e,"height")}(e);case"line":return function(e){return V({x:j(e,"x1"),y:j(e,"y1")},{x:j(e,"x2"),y:j(e,"y2")})}(e);case"polyline":return J(e);case"polygon":return function(e){var t=e.points;return J(e)+V(t.getItem(t.numberOfItems-1),t.getItem(0))}(e)}}function Z(e,t){var n=t||{},r=n.el||function(e){for(var t=e.parentNode;y.svg(t)&&y.svg(t.parentNode);)t=t.parentNode;return t}(e),i=r.getBoundingClientRect(),o=j(r,"viewBox"),a=i.width,s=i.height,u=n.viewBox||(o?o.split(" "):[0,0,a,s]);return{el:r,viewBox:u,x:u[0]/1,y:u[1]/1,w:a,h:s,vW:u[2],vH:u[3]}}function G(e,t,n){function r(n){void 0===n&&(n=0);var r=t+n>=1?t+n:0;return e.el.getPointAtLength(r)}var i=Z(e.el,e.svg),o=r(),a=r(-1),s=r(1),u=n?1:i.w/i.vW,c=n?1:i.h/i.vH;switch(e.property){case"x":return(o.x-i.x)*u;case"y":return(o.y-i.y)*c;case"angle":return 180*Math.atan2(s.y-a.y,s.x-a.x)/Math.PI}}function X(e,t){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=$(y.pth(e)?e.totalLength:e,t)+"";return{original:r,numbers:r.match(n)?r.match(n).map(Number):[0],strings:y.str(e)||t?r.split(n):[]}}function Q(e){return N(e?A(y.arr(e)?e.map(C):C(e)):[],(function(e,t,n){return n.indexOf(e)===t}))}function ee(e){var t=Q(e);return t.map((function(e,n){return{target:e,id:n,total:t.length,transforms:{list:q(e)}}}))}function te(e,t){var n=D(t);if(/^spring/.test(n.easing)&&(n.duration=w(n.easing)),y.arr(e)){var r=e.length;2===r&&!y.obj(e[0])?e={value:e}:y.fnc(t.duration)||(n.duration=t.duration/r)}var i=y.arr(e)?e:[e];return i.map((function(e,n){var r=y.obj(e)&&!y.pth(e)?e:{value:e};return y.und(r.delay)&&(r.delay=n?0:t.delay),y.und(r.endDelay)&&(r.endDelay=n===i.length-1?t.endDelay:0),r})).map((function(e){return L(e,n)}))}function ne(e,t){var n=[],r=t.keyframes;for(var i in r&&(t=L(function(e){for(var t=N(A(e.map((function(e){return Object.keys(e)}))),(function(e){return y.key(e)})).reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]),n={},r=function(r){var i=t[r];n[i]=e.map((function(e){var t={};for(var n in e)y.key(n)?n==i&&(t.value=e[n]):t[n]=e[n];return t}))},i=0;i<t.length;i++)r(i);return n}(r),t)),t)y.key(i)&&n.push({name:i,tweens:te(t[i],e)});return n}function re(e,t){var n;return e.tweens.map((function(r){var i=function(e,t){var n={};for(var r in e){var i=F(e[r],t);y.arr(i)&&1===(i=i.map((function(e){return F(e,t)}))).length&&(i=i[0]),n[r]=i}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}(r,t),o=i.value,a=y.arr(o)?o[1]:o,s=B(a),u=_(t.target,e.name,s,t),c=n?n.to.original:u,l=y.arr(o)?o[0]:c,d=B(l)||B(u),p=s||d;return y.und(a)&&(a=c),i.from=X(l,p),i.to=X(H(a,l),p),i.start=n?n.end:0,i.end=i.start+i.delay+i.duration+i.endDelay,i.easing=O(i.easing,i.duration),i.isPath=y.pth(o),i.isPathTargetInsideSVG=i.isPath&&y.svg(t.target),i.isColor=y.col(i.from.original),i.isColor&&(i.round=1),n=i,i}))}var ie={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,r,i){if(r.list.set(t,n),t===r.last||i){var o="";r.list.forEach((function(e,t){o+=t+"("+e+") "})),e.style.transform=o}}};function oe(e,t){ee(e).forEach((function(e){for(var n in t){var r=F(t[n],e),i=e.target,o=B(r),a=_(i,n,o,e),s=H($(r,o||B(a)),a),u=z(i,n);ie[u](i,n,s,e.transforms,!0)}}))}function ae(e,t){return N(A(e.map((function(e){return t.map((function(t){return function(e,t){var n=z(e.target,t.name);if(n){var r=re(t,e),i=r[r.length-1];return{type:n,property:t.name,animatable:e,tweens:r,duration:i.end,delay:r[0].delay,endDelay:i.endDelay}}}(e,t)}))}))),(function(e){return!y.und(e)}))}function se(e,t){var n=e.length,r=function(e){return e.timelineOffset?e.timelineOffset:0},i={};return i.duration=n?Math.max.apply(Math,e.map((function(e){return r(e)+e.duration}))):t.duration,i.delay=n?Math.min.apply(Math,e.map((function(e){return r(e)+e.delay}))):t.delay,i.endDelay=n?i.duration-Math.max.apply(Math,e.map((function(e){return r(e)+e.duration-e.endDelay}))):t.endDelay,i}var ue=0;var ce=[],le=function(){var e;function t(n){for(var r=ce.length,i=0;i<r;){var o=ce[i];o.paused?(ce.splice(i,1),r--):(o.tick(n),i++)}e=i>0?requestAnimationFrame(t):void 0}return"undefined"!=typeof document&&document.addEventListener("visibilitychange",(function(){pe.suspendWhenDocumentHidden&&(de()?e=cancelAnimationFrame(e):(ce.forEach((function(e){return e._onDocumentVisibility()})),le()))})),function(){e||de()&&pe.suspendWhenDocumentHidden||!(ce.length>0)||(e=requestAnimationFrame(t))}}();function de(){return!!document&&document.hidden}function pe(e){void 0===e&&(e={});var t,n=0,r=0,i=0,o=0,a=null;function s(e){var t=window.Promise&&new Promise((function(e){return a=e}));return e.finished=t,t}var u=function(e){var t=M(d,e),n=M(p,e),r=ne(n,e),i=ee(e.targets),o=ae(i,r),a=se(o,n),s=ue;return ue++,L(t,{id:s,children:[],animatables:i,animations:o,duration:a.duration,delay:a.delay,endDelay:a.endDelay})}(e);s(u);function c(){var e=u.direction;"alternate"!==e&&(u.direction="normal"!==e?"normal":"reverse"),u.reversed=!u.reversed,t.forEach((function(e){return e.reversed=u.reversed}))}function l(e){return u.reversed?u.duration-e:e}function f(){n=0,r=l(u.currentTime)*(1/pe.speed)}function h(e,t){t&&t.seek(e-t.timelineOffset)}function v(e){for(var t=0,n=u.animations,r=n.length;t<r;){var i=n[t],o=i.animatable,a=i.tweens,s=a.length-1,c=a[s];s&&(c=N(a,(function(t){return e<t.end}))[0]||c);for(var l=m(e-c.start-c.delay,0,c.duration)/c.duration,d=isNaN(l)?1:c.easing(l),p=c.to.strings,f=c.round,h=[],v=c.to.numbers.length,g=void 0,y=0;y<v;y++){var b=void 0,w=c.to.numbers[y],S=c.from.numbers[y]||0;b=c.isPath?G(c.value,d*w,c.isPathTargetInsideSVG):S+d*(w-S),f&&(c.isColor&&y>2||(b=Math.round(b*f)/f)),h.push(b)}var P=p.length;if(P){g=p[0];for(var x=0;x<P;x++){p[x];var k=p[x+1],E=h[x];isNaN(E)||(g+=k?E+k:E+" ")}}else g=h[0];ie[i.type](o.target,i.property,g,o.transforms),i.currentValue=g,t++}}function g(e){u[e]&&!u.passThrough&&u[e](u)}function y(e){var d=u.duration,p=u.delay,f=d-u.endDelay,y=l(e);u.progress=m(y/d*100,0,100),u.reversePlayback=y<u.currentTime,t&&function(e){if(u.reversePlayback)for(var n=o;n--;)h(e,t[n]);else for(var r=0;r<o;r++)h(e,t[r])}(y),!u.began&&u.currentTime>0&&(u.began=!0,g("begin")),!u.loopBegan&&u.currentTime>0&&(u.loopBegan=!0,g("loopBegin")),y<=p&&0!==u.currentTime&&v(0),(y>=f&&u.currentTime!==d||!d)&&v(d),y>p&&y<f?(u.changeBegan||(u.changeBegan=!0,u.changeCompleted=!1,g("changeBegin")),g("change"),v(y)):u.changeBegan&&(u.changeCompleted=!0,u.changeBegan=!1,g("changeComplete")),u.currentTime=m(y,0,d),u.began&&g("update"),e>=d&&(r=0,u.remaining&&!0!==u.remaining&&u.remaining--,u.remaining?(n=i,g("loopComplete"),u.loopBegan=!1,"alternate"===u.direction&&c()):(u.paused=!0,u.completed||(u.completed=!0,g("loopComplete"),g("complete"),!u.passThrough&&"Promise"in window&&(a(),s(u)))))}return u.reset=function(){var e=u.direction;u.passThrough=!1,u.currentTime=0,u.progress=0,u.paused=!0,u.began=!1,u.loopBegan=!1,u.changeBegan=!1,u.completed=!1,u.changeCompleted=!1,u.reversePlayback=!1,u.reversed="reverse"===e,u.remaining=u.loop,t=u.children;for(var n=o=t.length;n--;)u.children[n].reset();(u.reversed&&!0!==u.loop||"alternate"===e&&1===u.loop)&&u.remaining++,v(u.reversed?u.duration:0)},u._onDocumentVisibility=f,u.set=function(e,t){return oe(e,t),u},u.tick=function(e){i=e,n||(n=i),y((i+(r-n))*pe.speed)},u.seek=function(e){y(l(e))},u.pause=function(){u.paused=!0,f()},u.play=function(){u.paused&&(u.completed&&u.reset(),u.paused=!1,ce.push(u),f(),le())},u.reverse=function(){c(),u.completed=!u.reversed,f()},u.restart=function(){u.reset(),u.play()},u.remove=function(e){he(Q(e),u)},u.reset(),u.autoplay&&u.play(),u}function fe(e,t){for(var n=t.length;n--;)I(e,t[n].animatable.target)&&t.splice(n,1)}function he(e,t){var n=t.animations,r=t.children;fe(e,n);for(var i=r.length;i--;){var o=r[i],a=o.animations;fe(e,a),a.length||o.children.length||r.splice(i,1)}n.length||r.length||t.pause()}pe.version="3.2.1",pe.speed=1,pe.suspendWhenDocumentHidden=!0,pe.running=ce,pe.remove=function(e){for(var t=Q(e),n=ce.length;n--;){he(t,ce[n])}},pe.get=_,pe.set=oe,pe.convertPx=U,pe.path=function(e,t){var n=y.str(e)?T(e)[0]:e,r=t||100;return function(e){return{property:e,el:n,svg:Z(n),totalLength:Y(n)*(r/100)}}},pe.setDashoffset=function(e){var t=Y(e);return e.setAttribute("stroke-dasharray",t),t},pe.stagger=function(e,t){void 0===t&&(t={});var n=t.direction||"normal",r=t.easing?O(t.easing):null,i=t.grid,o=t.axis,a=t.from||0,s="first"===a,u="center"===a,c="last"===a,l=y.arr(e),d=l?parseFloat(e[0]):parseFloat(e),p=l?parseFloat(e[1]):0,f=B(l?e[1]:e)||0,h=t.start||0+(l?d:0),m=[],v=0;return function(e,t,g){if(s&&(a=0),u&&(a=(g-1)/2),c&&(a=g-1),!m.length){for(var y=0;y<g;y++){if(i){var b=u?(i[0]-1)/2:a%i[0],w=u?(i[1]-1)/2:Math.floor(a/i[0]),S=b-y%i[0],P=w-Math.floor(y/i[0]),x=Math.sqrt(S*S+P*P);"x"===o&&(x=-S),"y"===o&&(x=-P),m.push(x)}else m.push(Math.abs(a-y));v=Math.max.apply(Math,m)}r&&(m=m.map((function(e){return r(e/v)*v}))),"reverse"===n&&(m=m.map((function(e){return o?e<0?-1*e:-e:Math.abs(v-e)})))}return h+(l?(p-d)/v:d)*(Math.round(100*m[t])/100)+f}},pe.timeline=function(e){void 0===e&&(e={});var t=pe(e);return t.duration=0,t.add=function(n,r){var i=ce.indexOf(t),o=t.children;function a(e){e.passThrough=!0}i>-1&&ce.splice(i,1);for(var s=0;s<o.length;s++)a(o[s]);var u=L(n,M(p,e));u.targets=u.targets||e.targets;var c=t.duration;u.autoplay=!1,u.direction=t.direction,u.timelineOffset=y.und(r)?c:H(r,c),a(t),t.seek(u.timelineOffset);var l=pe(u);a(l),o.push(l);var d=se(o,e);return t.delay=d.delay,t.endDelay=d.endDelay,t.duration=d.duration,t.seek(0),t.reset(),t.autoplay&&t.play(),t},t},pe.easing=O,pe.penner=E,pe.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};
/*!
	* tabbable 5.1.3
	* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
	*/
var me=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],ve=me.join(","),ge="undefined"==typeof Element?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector;function ye(e,t){var n=[],r=[];return function(e,t,n){var r=Array.prototype.slice.apply(e.querySelectorAll(ve));t&&ge.call(e,ve)&&r.unshift(e);return r=r.filter(n)}(e,(t=t||{}).includeContainer,be).forEach((function(e,t){var i=ke(e);0===i?n.push(e):r.push({documentOrder:t,tabIndex:i,node:e})})),r.sort(Ee).map((function(e){return e.node})).concat(n)}function be(e){return!(!we(e)||function(e){return function(e){return Oe(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var t=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]}((e.form||e.ownerDocument).querySelectorAll('input[type="radio"][name="'+e.name+'"]'),e.form);return!t||t===e}(e)}(e)||ke(e)<0)}function we(e){return!(e.disabled||function(e){return Oe(e)&&"hidden"===e.type}(e)||function(e){if("hidden"===getComputedStyle(e).visibility)return!0;if((e.matches("details>summary:first-of-type")?e.parentElement:e).matches("details:not([open]) *"))return!0;for(;e;){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}
/*!
	* focus-trap 6.1.4
	* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
	*/(e)||function(e){return"DETAILS"===e.tagName&&Array.prototype.slice.apply(e.children).some((function(e){return"SUMMARY"===e.tagName}))}(e))}var Se,Pe=me.concat("iframe").join(",");function xe(e){if(!e)throw new Error("No node provided");return!1!==ge.call(e,Pe)&&we(e)}function ke(e){var t=parseInt(e.getAttribute("tabindex"),10);return isNaN(t)?function(e){return"true"===e.contentEditable}(e)?0:"AUDIO"!==e.nodeName&&"VIDEO"!==e.nodeName&&"DETAILS"!==e.nodeName||null!==e.getAttribute("tabindex")?e.tabIndex:0:t}function Ee(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex}function Oe(e){return"INPUT"===e.tagName}function Te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ae,Ce=(Ae=[],{activateTrap:function(e){if(Ae.length>0){var t=Ae[Ae.length-1];t!==e&&t.pause()}var n=Ae.indexOf(e);-1===n||Ae.splice(n,1),Ae.push(e)},deactivateTrap:function(e){var t=Ae.indexOf(e);-1!==t&&Ae.splice(t,1),Ae.length>0&&Ae[Ae.length-1].unpause()}});function Ie(e,t){var n=document,r="string"==typeof e?n.querySelector(e):e,i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){Te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},t),o={firstTabbableNode:null,lastTabbableNode:null,nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1},a={activate:function(e){if(o.active)return;v(),o.active=!0,o.paused=!1,o.nodeFocusedBeforeActivation=n.activeElement;var t=e&&e.onActivate?e.onActivate:i.onActivate;t&&t();return u(),a},deactivate:s,pause:function(){if(o.paused||!o.active)return;o.paused=!0,c()},unpause:function(){if(!o.paused||!o.active)return;o.paused=!1,v(),u()}};return a;function s(e){if(o.active){clearTimeout(Se),c(),o.active=!1,o.paused=!1,Ce.deactivateTrap(a);var t=e&&void 0!==e.onDeactivate?e.onDeactivate:i.onDeactivate;return t&&t(),(e&&void 0!==e.returnFocus?e.returnFocus:i.returnFocusOnDeactivate)&&De((function(){var e;g((e=o.nodeFocusedBeforeActivation,l("setReturnFocus")||e))})),a}}function u(){if(o.active)return Ce.activateTrap(a),Se=i.delayInitialFocus?De((function(){g(d())})):g(d()),n.addEventListener("focusin",f,!0),n.addEventListener("mousedown",p,{capture:!0,passive:!1}),n.addEventListener("touchstart",p,{capture:!0,passive:!1}),n.addEventListener("click",m,{capture:!0,passive:!1}),n.addEventListener("keydown",h,{capture:!0,passive:!1}),a}function c(){if(o.active)return n.removeEventListener("focusin",f,!0),n.removeEventListener("mousedown",p,!0),n.removeEventListener("touchstart",p,!0),n.removeEventListener("click",m,!0),n.removeEventListener("keydown",h,!0),a}function l(e){var t=i[e],r=t;if(!t)return null;if("string"==typeof t&&!(r=n.querySelector(t)))throw new Error("`"+e+"` refers to no known node");if("function"==typeof t&&!(r=t()))throw new Error("`"+e+"` did not return a node");return r}function d(){var e;if(!(e=null!==l("initialFocus")?l("initialFocus"):r.contains(n.activeElement)?n.activeElement:o.firstTabbableNode||l("fallbackFocus")))throw new Error("Your focus-trap needs to have at least one focusable element");return e}function p(e){r.contains(e.target)||(i.clickOutsideDeactivates?s({returnFocus:i.returnFocusOnDeactivate&&!xe(e.target)}):i.allowOutsideClick&&("boolean"==typeof i.allowOutsideClick?i.allowOutsideClick:i.allowOutsideClick(e))||e.preventDefault())}function f(e){r.contains(e.target)||e.target instanceof Document||(e.stopImmediatePropagation(),g(o.mostRecentlyFocusedNode||d()))}function h(e){if(!1!==i.escapeDeactivates&&function(e){return"Escape"===e.key||"Esc"===e.key||27===e.keyCode}(e))return e.preventDefault(),void s();(function(e){return"Tab"===e.key||9===e.keyCode})(e)&&function(e){if(v(),e.shiftKey&&e.target===o.firstTabbableNode)return e.preventDefault(),void g(o.lastTabbableNode);if(!e.shiftKey&&e.target===o.lastTabbableNode)e.preventDefault(),g(o.firstTabbableNode)}(e)}function m(e){i.clickOutsideDeactivates||r.contains(e.target)||i.allowOutsideClick&&("boolean"==typeof i.allowOutsideClick?i.allowOutsideClick:i.allowOutsideClick(e))||(e.preventDefault(),e.stopImmediatePropagation())}function v(){var e=ye(r);o.firstTabbableNode=e[0]||d(),o.lastTabbableNode=e[e.length-1]||d()}function g(e){e!==n.activeElement&&(e&&e.focus?(e.focus({preventScroll:!!i.preventScroll}),o.mostRecentlyFocusedNode=e,function(e){return e.tagName&&"input"===e.tagName.toLowerCase()&&"function"==typeof e.select}(e)&&e.select()):g(d()))}}function De(e){return setTimeout(e,0)}let Me;var Le={default:{show(e){pe({begin:()=>e.style.display="flex",complete:()=>{Me=Ie(e,{initialFocus:".aw-wpn-prompt__button--allow"}),Me.activate()},targets:e,translateY:["-100%",0],opacity:[0,1]})},hide(e){pe({complete:()=>{Me.deactivate(),e.style.display="none"},targets:e,translateY:[0,"-100%"],opacity:[1,0]})}}};const We=n.getLogger("WebPushPrompt");function Be(){}function Fe(e,t={}){const n=document.createElement(e);return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function je(e){e.style.display="block"}function Ue(e){e.style.display="none"}function Re(e,t){this.prompt=e,this.id=e.id,this.rules=e.rules,this.options={onAllow:Be,onBeforeShow:Be,onDismiss:Be,onHide:Be,onShow:Be,appendTo:document.body,show:je,hide:Ue,...t},this.el=null,this.allowBtn=null,this.dismissBtn=null,this.ruleTimeout=null,this.storage=l("aw-wpn-prompt-"+this.id),this.state={activeRuleIndex:null,isDisplayed:!1,isScheduled:!1,lastShown:null,visits:0},this.allow=this.allow.bind(this),this.dismiss=this.dismiss.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this)}Re.prototype.initializeState=async function(){const e=await this.storage.load();We.debug("Fetched stored state",e);const{activeRuleIndex:t,lastShown:n,visits:r}=e||{};return this.setState({activeRuleIndex:t||0,lastShown:n,visits:((Array.isArray(r)?r.length:r)||0)+1})},Re.prototype.setState=function(e){const t={...this.state,...e};return this.state=t,this.syncState()},Re.prototype.syncState=function(){const e={...this.state};return delete e.isDisplayed,delete e.isScheduled,We.debug("Syncing state to localStorage",e),this.storage.save(e)},Re.prototype.clearSyncedState=function(){return We.debug("Removing synced state from localStorage"),this.storage.remove()},Re.prototype.buildPrompt=function(){const{promptHtml:e,promptJson:t}=this.prompt,{name:n}=t;We.debug("Adding fonts link to document");const r=Fe("link",{rel:"stylesheet",type:"text/css",href:"https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,700,700i"});document.head.appendChild(r),We.debug("Adding prompt type styles link to document");const i=Fe("link",{rel:"stylesheet",type:"text/css",href:"https://assets.aweber-static.com/wpn/prompts.css"});document.head.appendChild(i),We.debug("Adding prompt template styles link to document");const o=Fe("link",{rel:"stylesheet",type:"text/css",href:`https://assets.aweber-static.com/wpn/css/${n}.css`});document.head.appendChild(o),We.debug("Adding prompt element to document");const a="aw-wpn-prompt--"+n;let s="aw-wpn-prompt--"+this.prompt.promptType;e.match(new RegExp(a))||(s+=" "+a);const u=Fe("div",{id:"aw-wpn-prompt-"+this.id,className:s,innerHTML:e,style:"display: none; z-index: 2147483647"});this.options.appendTo.appendChild(u),this.el=document.getElementById("aw-wpn-prompt-"+this.id),this.allowBtn=this.el.querySelector(".aw-wpn-prompt__button--allow"),this.dismissBtn=this.el.querySelector(".aw-wpn-prompt__button--dismiss")},Re.prototype.removePrompt=function(){this.el.parentNode.removeChild(this.el);const e=document.getElementById("aw-wpn-prompt-styles");e&&document.head.removeChild(e)},Re.prototype.attachEventHandlers=function(){this.allowBtn.addEventListener("click",this.allow),this.dismissBtn.addEventListener("click",this.dismiss),this.allowBtn.addEventListener("click",this.allow),this.dismissBtn.addEventListener("click",this.dismiss),document.addEventListener("keydown",this.handleKeydown)},Re.prototype.removeEventHandlers=function(){this.allowBtn.removeEventListener("click",this.allow),this.dismissBtn.removeEventListener("click",this.dismiss),document.removeEventListener("keydown",this.handleKeydown)},Re.prototype.show=function(){!1!==this.options.onBeforeShow(this)?(this.options.show(this.el),this.setState({isDisplayed:!0,isScheduled:!1}),this.options.onShow(this)):We.debug("onBeforeShow returned false, prompt will not be shown")},Re.prototype.hide=function(){this.options.hide(this.el),this.setState({isDisplayed:!1}),this.options.onHide()},Re.prototype.dismiss=function(){const{activeRuleIndex:e}=this.state,{repeat:t}=this.rules[e]||{},n=t?e:e+1;this.hide(),this.options.onDismiss(),this.setState({activeRuleIndex:n,lastShown:(new Date).getTime(),visits:0}),this.processActiveRule()},Re.prototype.allow=function(){this.hide(),this.clearSyncedState(),this.options.onAllow()},Re.prototype.handleKeydown=function(e){const{isDisplayed:t}=this.state;t&&27===e.keyCode&&(e.preventDefault(),this.dismiss())},Re.prototype.processActiveRule=function(){const{visits:e,activeRuleIndex:t,lastShown:n,isDisplayed:r,isScheduled:i}=this.state,o=this.rules[t];if(!o||i||r)return;const a=Date.now(),{afterIntervalMs:s,afterVisitCount:u,displayDelayMs:c}=o;if(e<u)return;const l=a-(n||a),d=Math.max(s-l,0)+c;d>2147483647||(We.debug(`Scheduling prompt to show in ${d}ms`),this.ruleTimeout=setTimeout(this.show,d),this.setState({isScheduled:!0}))},Re.prototype.destroy=function(){clearTimeout(this.ruleTimeout),this.ruleTimeout=null,this.removeEventHandlers(),this.removePrompt()};var ze=t((function(e,t){var n;n=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function i(){}function o(t,n,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},i.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var u in o)o[u]&&(s+="; "+u,!0!==o[u]&&(s+="="+o[u].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),u=s.slice(1).join("=");n||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var c=t(s[0]);if(u=(r.read||r)(u,c)||t(u),n)try{u=JSON.parse(u)}catch(e){}if(i[c]=u,e===c)break}catch(e){}}return e?i[e]:i}}return i.set=o,i.get=function(e){return a(e,!1)},i.getJSON=function(e){return a(e,!0)},i.remove=function(t,n){o(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))},e.exports=n()}));const qe=n.getLogger("Analytics"),Ke=e=>(e=>a(s(e.account)+"/dc",{method:"POST",body:JSON.stringify(o.decamelizeKeys(e))}))(e).then(()=>{qe.debug("Click recorded",e)}).catch(e=>{qe.error("Error processing event:",e)}),_e=e=>(e=>a(s(e.account)+"/do",{method:"POST",body:JSON.stringify(o.decamelizeKeys(e))}))(e).then(()=>{qe.debug("Open recorded",e)}).catch(e=>{qe.error("Error processing event:",e)}),He=e=>(e=>a(s(e.account)+"/dp",{method:"POST",body:JSON.stringify(o.decamelizeKeys(e))}))(e).then(()=>{qe.debug("Pageview recorded",e)}).catch(e=>{qe.error("Error processing event:",e)}),$e=async(e,t={})=>{const n={click:Ke,open:_e,pageview:He};if(!n[e])return void qe.warn("Unable to process unknown analytics event "+e);if(!t.account)return void qe.error("Unable to process analytics event. Missing account id.");if(!t.list)return void qe.error("Unable to process analytics event. Missing list id.");const r={account:t.account,list:t.list,message:null,msgType:null,timestamp:(new Date).toISOString()};let i;switch(e){case"open":i={message:t.message,msgType:"w",subscriber:t.subscriber};break;case"click":i={message:t.message,msgType:"w",subscriber:t.subscriber,url:"",destination:t.url};break;case"pageview":i={eventType:t.eventType||"",note:t.note||"",profile:"Web Push Notifications",source:window.location.search,url:window.location.href,visitor:ze.get("awt_")}}return n[e]({...r,...i})},Ve=n.getLogger("WebPush");function Je(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;e+=1)r[e]=n.charCodeAt(e);return r}function Ye(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e)))}function Ze(){return navigator.serviceWorker.ready.then(e=>e.pushManager.getSubscription())}const Ge={initCalled:!1,isSubscribing:!1,config:{},prompts:void 0,isWebPushSupported(){let e=!0;return"serviceWorker"in navigator||(Ve.warn("Service Worker is not supported."),e=!1),"PushManager"in window&&"Notification"in window||(Ve.warn("Push API is not supported."),e=!1),e},isMatchingSubscription(e){const t=e.options.applicationServerKey,n=new Uint8Array(t),r=Je(Ge.config.appServerKey);return n.length===r.length&&n.every((e,t)=>e===r[t])},async isSubscribed(){const e=await Ze();return!!e&&Ge.isMatchingSubscription(e)},isBlocked:()=>"denied"===window.Notification.permission,getPromptId(){const{prompts:e}=Ge;if(Array.isArray(e)&&e.length)return e[0].id},requestPermission:()=>"default"===window.Notification.permission?window.Notification.requestPermission():"granted"===window.Notification.permission?Promise.resolve(window.Notification.permission):(Ve.warn("Notifications are not permitted"),Promise.reject(window.Notification.permission)),async createSubscription(){const{appServerKey:e,list:t}=Ge.config,n=await(r=Je(e),navigator.serviceWorker.ready.then(e=>e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r})));var r;Ve.info("PushSubscription created."),Ve.debug(n);const i=Ge.getPromptId();return i?(({list:e,promptUuid:t,subscription:n})=>a("https://signup.aweber.com/web_push/subscribers",{method:"POST",body:JSON.stringify({list:e,permission_prompt:t,...n})}))({subscription:{endpoint:n.endpoint,expirationTime:n.expirationTime,keys:{auth:Ye(n.getKey("auth")),p256dh:Ye(n.getKey("p256dh"))}},promptUuid:i,list:t}).then(({data:e})=>{Ve.info("Subscriber registered."),Ve.debug("Subscriber ID: "+e.subscriber),Ve.debug("Prompt ID: "+e.signupPermissionPrompt)}):Promise.reject('Unable to create subscription: Expected "promptUuid" not to be undefined.')},async fetchPermissionPrompts(){const{list:e}=Ge.config;return await(({list:e})=>a("https://signup.aweber.com/web_push/permission_prompts?list="+e))({list:e}).then(e=>e.data)},async initPermissionPrompts(){const e=await Ge.fetchPermissionPrompts();Ve.debug("Loaded permission prompts",e),Ge.prompts=await Promise.all(e.map(async e=>{const t=await async function(e,t){if(!e)throw new Error("Web Push Prompt requires a permission prompt object");if(!t||!t.onAllow)throw new Error("Web Push Prompt requires options.onAllow to be specified");const{promptType:n}=e,r=Object.keys(Le);if(n&&!r.includes(n))throw new Error(`Unexpected prompt type: ${n}. Expected one of: ${r.join(", ")}`);const i={...Le[n],...t},o=new Re(e,i);return We.debug(`Created new "${n}" prompt`),We.debug("with options",i),await o.initializeState(),o.buildPrompt(),o.attachEventHandlers(),o.processActiveRule(),{destroy(){o.destroy()},el:o.el,id:o.id}}(e,{onAllow:()=>($e("pageview",{...Ge.config,eventType:"prompt_confirmed",note:e.id}),Ge.subscribeToPushNotifications().then(()=>{t.destroy()})),onBeforeShow:()=>{if("granted"===window.Notification.permission)return t.destroy(),!1},onDismiss:()=>$e("pageview",{...Ge.config,eventType:"prompt_dismissed",note:e.id}),onShow:()=>$e("pageview",{...Ge.config,eventType:"prompt_shown",note:e.id})});return t}))},async subscribeToPushNotifications(){if(!Ge.isSubscribing&&!await Ge.isSubscribed()){Ge.isSubscribing=!0;try{await Ge.requestPermission(),"granted"===window.Notification.permission&&await Ge.createSubscription()}catch(e){Ve.error(e)}Ge.isSubscribing=!1}},async migrateSubscription(){const e=await Ze();if(e){if(!Ge.isMatchingSubscription(e))return e.unsubscribe().then(()=>(Ve.debug("PushSubscription unsubscribed"),Ge.createSubscription().then(()=>{Ge.prompts.forEach(e=>e.destroy())})));Ve.debug("Existing subscription does not require migration.")}else Ve.debug("Existing subscription not found.")},async init(e,t,n){if(Ge.config.appServerKey=e,Ge.config.account=t,Ge.config.list=n,2===arguments.length&&(Ge.config.list=t,Ge.config.account=null,Ve.warn("`init` called with 2 arguments but 3 are expected. Ensure you have the latest JS snippet.")),e)if(Ge.isWebPushSupported())if(Ge.initCalled)Ve.warn("AWeber Web Push Notifications has already been initialized.");else if(Ge.initCalled=!0,Ge.isBlocked())Ve.debug("User has denied push notifications");else{try{await async function(){let e=!1;const t=await navigator.serviceWorker.getRegistrations();for(let n=0;n<t.length;n+=1)if(t[n].active.scriptURL.includes("/aweber-service-worker.js.php")){Ve.info("AWeber service worker already running in WordPress."),e=!0;break}if(!e)return navigator.serviceWorker.register("/aweber-service-worker.js")}(),Ve.info("Initialized AWeber Push Notifications"),Ve.debug("with options: ",Ge.config)}catch(e){return void Ve.error("Unable to initialize AWeber Web Push Notifications: service worker registration failed. "+e)}if(await Ge.isSubscribed())Ve.debug("Matching subscription exists, returning early");else{try{await Ge.initPermissionPrompts()}catch(e){return void Ve.error("Unable to initialize AWeber Web Push Notifications: error fetching prompts. "+e)}try{await Ge.migrateSubscription()}catch(e){Ve.error("Unable to migrate subscription: "+e)}}}else Ve.error("Unable to initialize AWeber Web Push Notifications: web push is not supported in this browser.");else Ve.error("Unable to initialize AWeber Web Push Notifications: missing application server key.")}},Xe=n.getLogger("AWeber"),Qe={},et={VERSION:"1.3.0",push(e){"function"==typeof e&&e()},initWebPush(...e){Qe.initWebPush||(Xe.warn("The `initWebPush` method is deprecated and will be removed in a future version. Use `AWeber.WebPush.init` instead."),Qe.initWebPush=!0),Ge.init(...e)},initWebPushSubscriptionFlow(){Qe.initWebPushSubscriptionFlow||(Xe.warn("The `initWebPushSubscriptionFlow` method is deprecated and will be removed in a future version. Use `AWeber.WebPush.subscribe` instead."),Qe.initWebPushSubscriptionFlow=!0),Ge.isWebPushSupported()&&!Ge.isBlocked()&&Ge.subscribeToPushNotifications()},__setLogLevel(e){n.setLevel(e)},WebPush:{}};Object.defineProperties(et.WebPush,{blocked:{enumerable:!0,get:()=>Ge.isBlocked()},config:{enumerable:!0,get:()=>Ge.config},init:{enumerable:!0,value:Ge.init},subscribe:{enumerable:!0,value:()=>{Ge.isWebPushSupported()&&!Ge.isBlocked()&&Ge.subscribeToPushNotifications()}},subscribed:{enumerable:!0,get:()=>!(!Ge.isWebPushSupported()||Ge.isBlocked())&&"granted"===window.Notification.permission},supported:{enumerable:!0,get:()=>Ge.isWebPushSupported()}}),Xe.info(`Loaded (version ${et.VERSION})`),Xe.debug("Current Page URL: "+location.href),"undefined"!=typeof window&&function(){const e=window.AWeber;window.AWeber=et,Array.isArray(e)&&e.forEach(et.push)}()}();
