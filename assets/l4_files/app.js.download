"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e});var T,b,S,x,w,M,L,A,I,k,N,_,O,R,D,P,B,U,o,i,F,H,V,e,q,z,t,G,W,j,K,J,Y,r,s,d,n,Q,Z,X,ee,l,te,ne,ae,oe,c,u,p,f,m,g,v,h=13,y=27,E="_kenytUserId_",ie="_kenytviewstate_",C="MessageHub",re="_kenytsessionstate_",se=":",le={CONTACT_FORM:{Trigger:"Open Lead Form"},APPOINTMENT_FORM:{Trigger:"Open Appointment Form"},ADDRESS_FORM:{Trigger:"Open Address Form"},LATLONG_FORM:{Trigger:"Open GeoLocation Form"},FILE_UPLOAD:{Trigger:"Open Upload Form"},CALLER:{Trigger:"Open Caller"},OTP:{Trigger:"Open OTP Form"},GENERIC_FORM:{Trigger:"Open Generic Form"},NAVIGATE:{Trigger:"NavigateTo",Pattern:/^NavigateTo\s*:\s*\[.*\]\(.*\)$/i},SETTINGS_OVERRIDE:{Trigger:"UpdateUxSettings",Pattern:/^UpdateUxSettings\s*:\s*.*$/i},SET_LANGUAGE:{Trigger:"Set Language"},SET_SESSION:{Trigger:"Set Session"},NOTIFY_LEAD_CAPTURE:{Trigger:"Notify Lead Capture"},OPEN_RAZORPAY_BUTTON:{Trigger:"Open Razorpay Button"}},de="phone::",ce="Intl Tel Input Plugin",ue="../ChatbotUI/external/IntlTelInput/utils.js",pe="_EMPTY_",fe="en",me="kenytUnreadMessage",ge=/(http|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?/i,ve=/\[.*\]\(.*\)/,he=/[\d]{4,}/,ye={TRACKING_ID:"UA-64989543-27",EVENT_INITIAL_LOAD:"initial_event",EVENT_DOCUMENT_READY:"document_ready",EVENT_COOKIES_DISABLED:"cookies_disabled",EVENT_LOAD_CHAT_REQUESTED:"load_chatbot_requested",EVENT_LOAD_CHAT_RECEIVED:"load_chatbot_received",EVENT_LOAD_CHAT_INTIME:"load_chatbot_intime",EVENT_VALID_BOT_ID:"valid_botid",EVENT_AUTO_MESSAGE_REQUESTED:"auto_message_requested",EVENT_AUTO_MESSAGE_SKIPPED:"auto_message_skipped",EVENT_AUTO_MESSAGE_RECEIVED:"auto_message_received",EVENT_FIRST_USER_REQUEST:"first_user_request",EVENT_INITIALIZE_CONNECTION:"initialize_connection",EVENT_FIRST_BOT_RESPONSE:"first_bot_response",EVENT_MESSAGE_SENT:"client_message_sent",EVENT_MESSAGE_RECEIVED:"client_message_received",EVENT_MESSAGE_DELAY:"reply_delay",EVENT_MESSAGE_UNSUCCESSFUl:"client_message_unsuccessful",EVENT_MESSAGE_FAILED:"client_message_failed",EVENT_LOCATION_OBTAINED:"location_obtained",EVENT_LOCATION_DENIED:"location_denied"},Ee=750,Ce="/signalr",Te="/api/botsetup/loadchatwindow",be="",Se="",xe="/botapp",we={PROD:"/dashboard",LOCAL:"http://localhost:4200"},Me=5,Le=3,Ae=1440,Ie={TYPING_INDICATOR:"TypingIndicator",SENDER_DETAILS:"MessageSenderInfo",OTP_FORM:"OTPForm",PHONE_NUMBER_FORM:"PhoneNumberForm",SHOW_MORE_BUTTON:"ShowMoreButton",SMALL_BUTTON_CARD:"SmallButtonCard",MEDIUM_BUTTON_CARD:"MediumButtonCard",VISITING_CARD:"VisitingCard",VERTICAL_CARD:"VerticalCard",CARD_BUTTON:"CardButton",HEADER_MENU_ITEM:"HeaderMenuItem",FILE_CARD:"FileCard",LOCATION_CARD:"LocationCard",FOOTER_MENU:"FooterMenu",INTERACTIVE_CARD:"InteractiveList",INTERACTIVE_MENU_CARD:"ShowInteractiveMenuButton"},ke="enable-on-bot-reply",Ne=[{text:"Afrikaans",value:"af",displayText:"Afrikaans"},{text:"Albanian",value:"sq",displayText:"shqipe"},{text:"Amharic",value:"am"},{text:"Arabic",value:"ar",displayText:"العَرَبِيَّة"},{text:"Armenian",value:"hy",displayText:"Հայերեն"},{text:"Azerbaijani",value:"az",displayText:"azərbaycan dili"},{text:"Basque",value:"eu",displayText:"euskara"},{text:"Belarusian",value:"be",displayText:"беларуская мова"},{text:"Bengali",value:"bn",displayText:"বাংলা"},{text:"Bosnian",value:"bs",displayText:"Bosanski Jezik"},{text:"Bulgarian",value:"bg",displayText:"български език"},{text:"Catalan",value:"ca",displayText:"català"},{text:"Cebuano",value:"ceb",displayText:"Cebuano"},{text:"Chadic",value:"ha",displayText:"Harshen Hausa"},{text:"Chinese (Mandarin)",value:"zh-CN",displayText:"中文"},{text:"Chinese(Traditional)",value:"zh-TW"},{text:"Corsican",value:"co",displayText:"Espanol - CO"},{text:"Croatian",value:"hr",displayText:"Hrvatski Jezik"},{text:"Czech",value:"cs",displayText:"český jazyk"},{text:"Danish",value:"da",displayText:"Dansk"},{text:"Dutch",value:"nl",displayText:"Nederlands"},{text:"English",value:"en"},{text:"Esperanto",value:"eo",displayText:"Esperanto"},{text:"Estonian",value:"et",displayText:"Eesti"},{text:"Filipino",value:"fl",displayText:"Pilipino"},{text:"Finnish",value:"fi",displayText:"Suomi"},{text:"French",value:"fr",displayText:"Français"},{text:"Frisian",value:"fy"},{text:"Galician",value:"gl",displayText:"Galego"},{text:"Georgian ",value:"ka",displayText:"ქართული"},{text:"German",value:"de",displayText:"Deutsch"},{text:"Greek",value:"el",displayText:"ελληνικά"},{text:"Gujarati",value:"gu",displayText:"ગુજરાતી"},{text:"Haitian Creole",value:"ht",displayText:"Kreyol Ayisyen"},{text:"Hausa",value:"ha ",displayText:"هَوُسَ"},{text:"Hawaiian",value:"haw"},{text:"Hebrew",value:"he",displayText:"עברית"},{text:"Hindi",value:"hi",displayText:"हिन्दी"},{text:"Hmong",value:"hmn",displayText:"Hmong"},{text:"Hungarian",value:"hu",displayText:"magyar"},{text:"Icelandic",value:"is",displayText:"Islenka"},{text:"Igbo",value:"ig",displayText:"Ásụ̀sụ̀"},{text:"Indonesian",value:"id",displayText:"Indonesia"},{text:"Irish",value:"ga",displayText:"Gaeilge"},{text:"Italian",value:"it",displayText:"Italiano"},{text:"Japanese",value:"ja",displayText:"日本語"},{text:"Javanese",value:"jv",displayText:"Basa Jawa"},{text:"Javanese",value:"jw"},{text:"Kannada",value:"kn",displayText:"ಕನ್ನಡ"},{text:"Kazakh",value:"kk",displayText:"қазақ тілі"},{text:"Khmer",value:"km    ",displayText:"ខ្មែរ,"},{text:"Korean",value:"ko",displayText:"한국어"},{text:"Kurdish",value:"ku"},{text:"Kyrgyz",value:"ky"},{text:"Lao",value:"lo",displayText:"ພາສາລາວ"},{text:"Latin",value:"la",displayText:"Latine"},{text:"Latvian",value:"lv",displayText:"latviešu valoda"},{text:"Lithuanian",value:"lt",displayText:"lietuvių kalba"},{text:"Luxembourgish",value:"lb"},{text:"Macedonian",value:"mk",displayText:"македонски јазик"},{text:"Malagasy",value:"mg",displayText:"Malagasy"},{text:"Malay",value:"ms",displayText:"Bahasa Melayu"},{text:"Malayalam",value:"ml",displayText:"മലയാളം"},{text:"Maltese",value:"mt",displayText:"Malti"},{text:"Maori",value:"mi",displayText:"Māori"},{text:"Marathi",value:"mr",displayText:"मराठी"},{text:"Mongolian",value:"mn",displayText:"монгол"},{text:"Myanmar(Burmese)",value:"my"},{text:"Nepali",value:"ne",displayText:"नेपाली"},{text:"Norwegian",value:"no",displayText:"Norsk"},{text:"Nyanja",value:"ny",displayText:"Chichewa"},{text:"Pashto",value:"ps"},{text:"Persian",value:"fa"},{text:"Polish",value:"pl",displayText:"Polski"},{text:"Portuguese(Portugal, Brazil)",value:"pt",displayText:"Português"},{text:"Punjabi",value:"pa",displayText:"ਪੰਜਾਬੀ"},{text:"Romanian",value:"ro",displayText:"limba română "},{text:"Russian",value:"ru",displayText:"русский язык"},{text:"Samoan",value:"sm"},{text:"Scots Gaelic",value:"gd",displayText:"Gàidhlig na h-Alba"},{text:"Serbian",value:"sr",displayText:"српски језик"},{text:"Shona",value:"sn"},{text:"Sindhi",value:"sd"},{text:"Sinhala(Sinhalese)",value:"si",displayText:"සිංහල"},{text:"Slovak",value:"sk",displayText:"slovenčina"},{text:"Slovenian",value:"sl",displayText:"Slovenski Jezik"},{text:"Somali",value:"so",displayText:"Soomaali"},{text:"Spanish",value:"es",displayText:"Español"},{text:"Southern Sotho",value:"st",displayText:"Sesotho"},{text:"Sundanese",value:"su",displayText:"Basa Sunda"},{text:"Swahili",value:"sw",displayText:"Kiswahili"},{text:"Swedish",value:"sv",displayText:"Sverige"},{text:"Tagalog(Filipino)",value:"tl"},{text:"Tajik",value:"tg",displayText:"тоҷикӣ"},{text:"Tamil",value:"ta",displayText:"தமிழ்"},{text:"Telugu",value:"te",displayText:"తెలుగు"},{text:"Thai",value:"th",displayText:"ไทย"},{text:"Turkish",value:"tr",displayText:"Türkçe"},{text:"Ukrainian",value:"uk",displayText:"українська мова"},{text:"Urdu",value:"ur",displayText:"اُردُو"},{text:"Uzbek",value:"uz",displayText:"Oʻzbek"},{text:"Vietnamese",value:"vi",displayText:"Tiếng Việt"},{text:"Welsh",value:"cy"},{text:"Xhosa",value:"xh"},{text:"Yiddish",value:"yi",displayText:"ייִדיש"},{text:"Yoruba",value:"yo",displayText:"Ede Yorùbá"},{text:"Zulu",value:"zu",displayText:"isiZulu"}],_e={EMAIL_VALIIDATION_PATTERN:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,10}|[0-9]{1,5})(\]?)$/,PHONE_VALIDATION_SOURCE:ce,URL_VALIIDATION_PATTERN:/^(http[s]?:\/\/)?(www\.)?(\w)+\.(\w)+([\/.][\w-#]*)*$/},Oe=Zn(),Re=Oe+Ce,De=Oe+Te,Pe=Oe+"/api/file/upload",Be={None:0,Thumbnail:1,Hero:2,Image:3,Gif:4,Video:5,QuickLink:6,SmallButton:7,MediumButton:8,VisitingCard:9,VerticalCard:10,Location:11,File:12,FooterMenu:13,InteractiveList:101},Ue={UserMessage:1,AutoMessage:2,ManualMessage:3},Fe={UnreadMessage:"kenytUnreadMessage",ChatWindowClose:"kenytChatWindowClose",ChatWindowOpen:"kenytChatWindowOpen",FullScreenImage:"kenytFullScreenImage",NavigateToPage:"kenytNavigateToPage",ToggleFullScreen:"kenytToggleFullscreen",ForceFullHeight:"kenytForceFullHeight",TextColor:"kenytTextColor",IsWindowMinimizedResponse:"kenytIsWindowMinimizedResponse",GetPageTitle:"kenytPageTitle",GetReferrer:"kenytPageReferrer",Initialize:"kenytInitialize",PageInfoRequest:"kenytPageInfoRequest",PageInfoResponse:"kenytPageInfoResponse",CustomEventDispatch:"kenytCustomEventDispatch",SettingsUpdate:"kenytSettingsUpdate",UpdateChatBubbleColor:"kenytUpdateChatBubbleColor",UpdateAttentionMessage:"kenytUpdateAttentionMessage",UpdateBotPosition:"kenytUpdateBotPosition",MediaStreamingCommand:"kenytMediaStreamingCommand",SendMessage:"kenytSendMessage",ReportGoogleAnalyticsEvent:"reportGoogleAnalyticsEvent"},He={Load:"kenyt_Load",ChatStart:"kenyt_ChatStart",ContactFormSubmit:"kenyt_ContactFormSubmit",UserMessage:"kenyt_UserMessage"},Ve={Form:"Form"},qe={SessionCount:1},ze=!1,Ge={},We={},je=!0,Ke={},$e=!1,Je={pageStartAt:null,isSkipped:!0,isSent:!1,isSentAck:!1,isReceived:!1,sentAt:null,receivedAt:null},Ye={FrameColor:"",FrameColorGradient:"",HeaderTitle:"Automated Live Chat",HeaderSubTitle:"Online",EnableSpeech:"False",HeaderFontSize:"",HeaderTextColor:"#ffffff",FontSize:"",FontFamily:"",UserChatBubbleColor:"",UserChatBubbleColorGradient:"",BotChatBubbleColor:"#ffffff",PlaceholderText:"Type your message...",ShowPoweredBy:"True",PoweredBy:{},BotTextColor:"#000",UserTextColor:"#000",BackgroundImage:"",BackgroundColor:"",CustomPanelCss:"",AvatarImage:"/api/botsetup/getimage?imagetype=chatbubble-icon&botid=",DesktopMinimizeBotAtStart:"True",MobileMinimizeBotAtStart:"True",OpenWindowAfterMilliSeconds:"0",Languages:"",UserPersona:"you",BotPersona:"chatbot",AttentionMessage:"",LiveAgentCall:"False",HideMenuInHeader:"False"},Qe={adaptiveHeight:!0,dots:!1,mobileFirst:!0,arrows:!0,autoplay:!0,autoplaySpeed:5e3},Ze=[],Xe={},et={headerMenu:{container:null,content:null},footerMenu:{container:null,content:null}},tt=[],nt=!1,at=!0,ot=1,it=!1,rt=!1,st=!1,lt={senderDetailsView:null,indicatorView:null},dt={"See Details":"See Details",Submit:"Submit","None of the above":"None of the above","Contact Information":"Contact Information","Please enter your contact details":"Please enter your contact details",Email:"Email",Phone:"Phone",Mobile:"Mobile"},ct={audio:!0},ut=null,pt={};function ft(){window.navigator.geolocation&&window.navigator.geolocation.getCurrentPosition(function(e){console.debug(e),p=e.coords,gt("event",ye.EVENT_LOCATION_OBTAINED),Bt("Coordinates::"+e.coords.latitude+" "+e.coords.longitude)},function(e){Bt("Coordinates denied by user"),console.warn("[Kenyt.AI] Location permission denied"),gt("event",ye.EVENT_LOCATION_DENIED)},{enableHighAccuracy:!0})}function mt(e,t){return t=t||window.location.href,new URL(t).searchParams.get(e)}function gt(){window.dataLayer.push(arguments)}function vt(e,t){var n=e&&e.lineno||"0",a=e&&e.colno||"0",o="["+(e&&e.filename||"unknown-file")+":"+n+":"+a+"] "+(e&&e.message||"null");Yn()||gt("event","exception",{description:o,fatal:t||!1}),console.debug(new Date+" "+o)}function ht(){var e=mt("botid");Yn()&&(window["ga-disable-"+ye.TRACKING_ID]=!0),gt("js",new Date);var t=mt("googleAnalyticsId");t||(t=ye.TRACKING_ID),gt("config",t,{custom_map:{dimension1:"botClientId"}}),e&&gt("event",ye.EVENT_INITIAL_LOAD,{botClientId:e}),window.addEventListener("error",function(e){vt(e,!1)})}function yt(){ba("Initializing connection");(o=$.hubConnection(Re)).qs="botid="+V,Yn()&&(o.logging=!0),o.connectionSlow(function(){console.warn("[Kenyt.AI] Connection is slow, may get disconnected"),gt("event","connection_slow",Ma("connection"))}),o.reconnecting(function(){ee.tryingToReconnect=!0,ee.isConnected=!1,ba("Reconnecting..."),console.warn("[Kenyt.AI] Lost connection to server, trying to reconnect..."+new Date),gt("event","connection_lost",Ma("connection"))}),o.reconnected(function(){ee.tryingToReconnect=!1,ee.isConnected=!0,ba("Reconnected"),Sa(),console.warn("[Kenyt.AI] Reconnected to server..."+new Date),gt("event","reconnected",Ma("connection")),Ca()}),(i=o.createHubProxy(C)).on("BotReply",Mt),i.on("ManualReply",Lt),i.on("Error",_t),i.on("NotifyAgentJoin",Qa),i.on("NotifyAgentExit",Za),i.on("NotifyWebRtcSignal",So),i.on("ChangeLanguage",Dt),Et(bt,St,!1),o.disconnected(function(){if(o.lastError){var e=new Date;console.log("Disconnected at "+e),console.log("Disconnected. Reason: "+o.lastError.message);var t=void 0;t=ee.tryingToReconnect?"Disconnected after reconnecting failed;":"Disconnected without reconnecting;",t=o.lastError.message||t,console.error("[Kenyt.AI] "+t),ee.isConnected=!1,ee.tryingToReconnect=!1,Sa(),oe&&(ba("Connection disconnected, Reconnecting in 5 secs..."),window.setTimeout(function(){yt()},5e3),t="(Reconnecting) "+t),vt({message:"Connection Disconnected: "+t},!0)}})}function Et(e,t,n){n?(gt("event","forced_longpolling"),o.start({transport:"longPolling"}).done(e).fail(t)):o.start().done(e).fail(t)}function Ct(){A.addEventListener("keydown",vn),A.addEventListener("focus",function(){wa()&&Da(),ha(M)}),k.addEventListener("click",hn),N.addEventListener("click",to),_&&_.addEventListener("click",function(e){no()}),P.addEventListener("click",function(e){e.stopPropagation();var t=P.getAttribute("data-toggle");_a(),gt("event","Button_Minimize_Maximize",Ma("user_interaction",null,t))}),B.addEventListener("click",kn),window.addEventListener("beforeunload",xt),w.addEventListener("click",kn),x.addEventListener("click",kn),S.parentElement.addEventListener("click",kn),document.addEventListener("keydown",function(e){var t=void 0;"key"in e?"Escape"!==e.key&&"Esc"!==e.key||(t=!0):t=e.keyCode===y,t&&kn()}),window.addEventListener("message",function(e){if("object"===a(e.data)&&e.data.type){var t=e.data;t.type===Fe.IsWindowMinimizedResponse?(je=t.value,Wn()):t.type===Fe.GetPageTitle?Ke.pageTitle=t.value:t.type===Fe.GetReferrer?Ke.pageReferrer=t.value:t.type===Fe.PageInfoResponse?t.value&&xa(t.value):t.type===Fe.SettingsUpdate?t.value&&Tn(t.value,!1,!0):t.type===Fe.MediaStreamingCommand?xo(t.value):t.type===Fe.SendMessage?Bt(t.value,"",!1,!0):t.type===Fe.ReportGoogleAnalyticsEvent&&(Yn()||(t.value.isException?gt("event",t.value.eventName,t.value.details):gt("event",t.value.eventName)))}})}function Tt(){if(o)try{o.stop()}catch(e){console.debug("Manual disconnection failed")}}function bt(){if($e=!1,gt("event",o&&o.transport&&o.transport.name||"unknown",Ma("transport_type")),Sa(),ee.isConnected=!0,ee.tryingToReconnect=!1,Z){var e={BotClientId:Z.BotId,Conversation:{ConversationId:H},User:{UserId:F}};i.invoke("Subscribe",e),Ca()}}function St(e){console.debug("connection failed"),console.debug(arguments),e.message=e.message||"",e.message="Failed Server Connection: "+e.message,vt(e)}function xt(){Tt();var e=Kn();e&&e.messages&&(te=e.messages),Wn()}function wt(){}function Mt(t){if(console.debug(t),t){if(s=new Date,r){var e=(s.valueOf()-r.valueOf())/1e3;Le<e&&gt("event",ye.EVENT_MESSAGE_DELAY,Ma("messages",null,e))}u&&!c&&(c=!0,gt("event",ye.EVENT_FIRST_BOT_RESPONSE)),t.ClearChat&&ja(),Qt(t.BotMenu),t.Messages&&0<t.Messages.length?t.Messages.forEach(function(e){e.DisplayName=t.DisplayName,Gt(e),Wn()}):Ht(),oe&&gt("event",ye.EVENT_MESSAGE_RECEIVED,Ma("messages"));var n=document.getElementsByClassName(ke);if(n)for(var a=0;a<n.length;a++)It(n[a])}}function Lt(e){var t={Text:e.Text,RichCards:[],CardsType:Be.None,DisplayName:e.SenderName};t.Text&&le.SETTINGS_OVERRIDE.Pattern.test(t.Text.trim())?Tn(Ha(t.Text),!0):(t.Text&&($t(t),ya(t.Text)),e.Suggestion&&(e.Suggestion.DisplayName=e.SenderName,$t(e.Suggestion),ya(e.Suggestion.Text)))}function At(e,t,n,a){console.debug("Received values from form"),console.debug(t),kt(e.target,[ke]);var o={},i=!0;t.forEach(function(e){var t=e.inputElementRef?e.inputElementRef.value:"";if(t&&"checkbox"===e.datatype&&(e.inputElementRef.checked||(t="")),e.isMandatory||Un(t)){e.validationPattern&&!Ja(e.validationPattern)&&(e.validationPattern=new RegExp(e.validationPattern));var n=!0;n=e.validationPattern?e.validationPattern.test(t):Un(t),e.validationSource&&e.pluginObj&&e.validationSource===ce&&(n=e.pluginObj.isValidNumber(),t=e.pluginObj.getNumber()),n?(console.debug("Setting User."+e.field+" = "+t),da(e),o[e.field]=t):(console.debug("Form not valid"),ca(e),i=!1)}});var r=!0;if(i)if(n)if(a&&"values"===a){var s=[];Object.keys(o).forEach(function(e){s.push(""+o[e])});var l=s.join("\n");Un(l)&&(Bt(n,null,!1,!1,!1,l),r=!1)}else 0<Object.keys(o).length&&(Bt(n,null,!1,!1,!1,o),r=!1);else{var d=ua(o);Un(d)&&(Bt(d,null,!1,!0),r=!1)}r&&It(e.target)}function It(e){e&&e.classList&&(e.disabled=!1,e.classList.remove(ke))}function kt(t,e){t&&t.classList&&(t.disabled=!0,e&&e.forEach(function(e){return t.classList.add(e)}))}function Nt(o){if(o){var e=function(){var n=so().fields;console.debug(o),console.debug(n);var e=!0;if(o.length===n.length)for(var t=function(t){if(!o.find(function(e){return e.field===n[t].field}))return e=!1,"break"},a=0;a<n.length;a++){if("break"===t(a))break}else e=!1;return console.debug("isContactForm: "+e),{v:e}}();if("object"===(void 0===e?"undefined":a(e)))return e.v}}function _t(e){console.error(e),e&&(e.message=e.message||"",e.message="Handle Error: "+e.message),vt(e)}function Ot(e){return console.debug("Received UserId: "+e),F=e,Wn(),!0}function Rt(e){return console.debug("Received ConversationId: "+e),H=e,pa(Fe.Initialize,H),Wn(),!0}function Dt(e){if(e){if(console.debug("Received language settings from server"),console.debug(e),e.LanguageCode&&La(e.LanguageCode,e.PreventHiMessage),e.Personas)for(var t in e.Personas)Ba(t,e.Personas[t],!0);if(e.Buttons)for(var t in e.Buttons)dt[t]=e.Buttons[t]}}function Pt(t){var n={};return t&&Object.keys(t).forEach(function(e){e in Ye&&(n[e]=t[e])}),n}function Bt(e,t,n,a,o,i,r){if(n||!e||0!==e.trim().length){var s=void 0;if(t&&!a){s=_n(t,'<span class="fa fa-spin fa-circle-o-notch"></span> sending..'),"user"!==d&&(Oa("user",ma(),!0),d="user"),En(s),Ft(We.name)}var l={RequestType:n?Ue.AutoMessage:Ue.UserMessage,Text:e,BotClientId:Z?Z.BotId:0,Conversation:{IsLocal:rt,SourceUrl:W,ConversationId:H,Context:j},User:{Name:"",UserId:F},IsTest:G,ConversationLanguage:ne||"",IsHidden:!!o};i&&(l.Payload=i,r&&(l.PayloadType=r)),Je.pageStartAt=new Date,ee.isConnected?Ut(l,s,t,a):(console.warn("[Kenyt.AI] Connection not yet initiated, suspending message.."),mo(l,s||null,t,a),yt())}}function Ut(t,n,a,o){if(i){if(console.debug("Sending message to server"),console.debug("BotClientName: "+V),console.debug(t),u||t.RequestType===Ue.UserMessage||(u=!0,gt("event",ye.EVENT_FIRST_USER_REQUEST)),!oe&&t.RequestType!==Ue.AutoMessage){oe=!0,fo(He.ChatStart,{messageText:a||t.Text});var e=ro();Ka(e)&&(t.BrowserInformation=e)}F&&!t.User.UserId&&(t.User.UserId=F),H&&!t.Conversation.ConversationId&&(t.Conversation.ConversationId=H),t.Conversation.TimezoneOffsetMinutes=-1*(new Date).getTimezoneOffset(),t.BotUserWebContext=qe,i.invoke("UserMessage",Z,t).done(function(e){e?(r=new Date,qt(n),t.RequestType===Ue.AutoMessage&&(Je.isSentAck=!0),t.RequestType===Ue.UserMessage&&(st||G||window.setTimeout(function(){pa(Fe.PageInfoRequest)},100),fo(He.UserMessage,{messageText:t.Text}))):(ba("Send failed. Reconnecting..."),window.setTimeout(function(){yt()},5e3),t.RequestType===Ue.UserMessage&&(mo(t,n,a,o),o=!0,gt("event",ye.EVENT_MESSAGE_UNSUCCESSFUl)),ee.isConnected=!1)}).fail(function(e){ba("Send failed. Reconnecting..."),window.setTimeout(function(){yt()},5e3),t.RequestType===Ue.UserMessage&&(mo(t,n,a,o),o=!0,gt("event",ye.EVENT_MESSAGE_UNSUCCESSFUl)),ee.isConnected=!1,zt(e),console.debug("Connection lost, Suspending message.."),o=!0}),o||te.push({id:ot++,isUserMessage:!0,message:t.Text,displayMessage:a,messageTimestamp:ma()}),Kt(),oe&&gt("event",ye.EVENT_MESSAGE_SENT,Ma("messages")),Wn()}else console.error("[Kenyt.AI] Cannot send message - HubProxy is null")}function Ft(e){Ht();var t=Vt(e);lt.indicatorView=t[0],lt.senderDetailsView=t[1],L.appendChild(lt.senderDetailsView),L.appendChild(lt.indicatorView)}function Ht(){lt.senderDetailsView&&(lt.senderDetailsView.remove(),lt.senderDetailsView=null),lt.indicatorView&&(lt.indicatorView.remove(),lt.indicatorView=null)}function Vt(e){var t=document.createElement("div"),n=On();n.appendChild(lo(Ie.TYPING_INDICATOR)),t.classList.add("col-12"),t.appendChild(n);var a=lo(Ie.SENDER_DETAILS);return a.querySelector("[data-persona]").textContent=e,[t,a]}function qt(e){if(e){var t=e.querySelector(".message-timestamp");t&&t.remove()}}function zt(e){console.debug("Sending message failed"),e&&(console.error(e),e.message=e.message||"",e.message="Failed Message: "+e.message,vt(e))}function Gt(e){0<Ze.length?Ze.push(e):0<e.SendWithDelayMs?(Ze.push(e),window.setTimeout(function(){Wt()},e.SendWithDelayMs)):0<e.SendOnSilenceMs?(Ze.push(e),window.setTimeout(function(){Wt()},10)):$t(e)}function Wt(){if(0<Ze.length){var e=Ze.splice(0,1)[0];0<e.SendOnSilenceMs?jt(e.SendOnSilenceMs,function(){$t(e),ya(e.Text)}):($t(e),ya(e.Text)),0<Ze.length&&0===Ze[0].SendWithDelayMs?Wt():0<Ze.length&&0<Ze[0].SendWithDelayMs?window.setTimeout(function(){Wt()},Ze[0].SendWithDelayMs):console.debug("No items in message queue")}}function jt(e,t){Kt(),l=window.setTimeout(function(){t()},e)}function Kt(){l&&(window.clearTimeout(l),l=0)}function $t(e){Ft("bot"===e.DisplayName?We.name:e.DisplayName),window.setTimeout(function(){Ht(),console.debug(e),Jt(e),d=e.DisplayName,te.push({id:ot++,isUserMessage:!1,message:e,messageTimestamp:ma(),displayMessage:null}),Wn()},Ee)}function Jt(e,t){if(e.DisplayName!==d&&Oa(e.DisplayName,ma()),e.Command&&e.Command.Name)if(e.Command.Name===le.CONTACT_FORM.Trigger)Va(so(),qa(e.Command.Value)),Ga(so(),e.DisplayName);else if(e.Command.Name===le.APPOINTMENT_FORM.Trigger)Va(co(),qa(e.Command.Value)),Ga(co(),e.DisplayName);else if(e.Command.Name===le.ADDRESS_FORM.Trigger)Va(po(),qa(e.Command.Value)),Ga(po(),e.DisplayName);else if(e.Command.Name===le.LATLONG_FORM.Trigger)t||ft();else if(e.Command.Name===le.FILE_UPLOAD.Trigger){var a=qa(e.Command.Value);(r=uo()).onSubmit=function(e){e.preventDefault();var t=e.target.getElementsByTagName("button");if(t&&t.length)for(var n=0;n<t.length;n++)kt(t[n]);var o=!0,i=[];r.fields.forEach(function(a){var t=[];t.push({inputElementRef:a.inputElementRef,feedbackElementRef:a.feedbackElementRef}),a.extraInputs&&a.extraInputs.forEach(function(e){t.push(e)}),t.forEach(function(e){var t=e.inputElementRef.value;if(a.isMandatory&&0==i.length||Un(t)){var n=Un(t);if(n&&"file"==a.datatype){20971520<e.inputElementRef.files[0].size&&(n=!1)}n?(console.debug("Setting User."+a.field+" = "+t),da(e),i.push(e.inputElementRef.files[0])):(console.debug("Form not valid"),ca(e),o=!1)}})}),o||(i=[]),Yt(i,a,e)},Va(r,a),Ga(r,e.DisplayName)}else if(e.Command.Name===le.CALLER.Trigger)t||bo(e);else if(e.Command.Name===le.OTP.Trigger){if(e.Command.Value){var n=null;try{n=JSON.parse(e.Command.Value).phone}catch(e){console.error("Error parsing command value",e)}En(Rn(cn(n)))}}else if(e.Command.Name===le.GENERIC_FORM.Trigger){var r;if(e.Command.Value)(r=JSON.parse(e.Command.Value))&&(za(r),Va(r,r.settings),Ga(r,e.DisplayName))}else if(e.Command.Name===le.NAVIGATE.Trigger){if(!t){var o={url:e.Command.Value};pa(Fe.NavigateToPage,o)}}else if(e.Command.Name===le.SETTINGS_OVERRIDE.Trigger){Tn(Ha(e.Command.Value),!0)}else if(e.Command.Name===le.SET_SESSION.Trigger)t||Na(qa(e.Command.Value));else if(e.Command.Name===le.NOTIFY_LEAD_CAPTURE.Trigger){if(!t){var i=qa(e.Command.Value);fo(He.ContactFormSubmit,i)}}else if(e.Command.Name===le.OPEN_RAZORPAY_BUTTON.Trigger){En(yn(qa(e.Command.Value)))}if(e.Text||0<e.RichCards.length){var s=On(e.Text,e.RichCards,e.CardsType,e.ContentType,e.XPath||"",e.Name);e.CardsType&&e.CardsType===Be.FooterMenu&&(et.footerMenu.content=e),En(s),it&&Un(e.Text)&&oo(e.Text)}}function Yt(t,n,a){if(t&&0<t.length){var e=t[0];t.shift();var o=new FormData;o.append("UploadFile",e);var i=n.FailureCallback||"submit file failure",r={};r.FileName=e.name,$.ajax({url:Pe+"?botId="+V+"&userId="+F,type:"POST",data:o,success:function(e){e&&e.item2?Bt(n.SubmitCallback||e.item1,null,!1,!0,!1,e.item2,"file"):Bt(i,null,!1,!0,!1,r)},error:function(e){r.message=e,Bt(i,null,!1,!0,!1,r)},complete:function(e){Yt(t,n,a)},cache:!1,contentType:!1,processData:!1})}else{var s=a.target.getElementsByTagName("button");if(s&&s.length)for(var l=0;l<s.length;l++)It(s[l])}}function Qt(e){e&&e.HeaderMenu&&Zt(e.HeaderMenu)}function Zt(e){if(et.headerMenu.container&&e&&e.RichCards){et.headerMenu.content=e;var o=et.headerMenu.container.getElementsByClassName("dropdown-menu");if(0<o.length){var i=e.RichCards,r=0;i&&i.length&&i.forEach(function(e){if(e){r++;var t=rn(e,Ie.HEADER_MENU_ITEM,r,i.length),n=t.innerText,a=t.getAttribute("message");a||(a=t.innerText),t.addEventListener("click",function(){Bt(a,n)}),o[0].appendChild(t)}})}}}function Xt(e,t){var n=document.getElementById("footer-menu");if(e&&(Xe.previousStateLoaded||et.footerMenu.isOpened)){var a=e.getElementsByClassName("interactive-menu-options");if(a&&0<a.length)a=a[0],et.footerMenu.optionsContainer.appendChild(a),a.classList.remove("d-none"),n.classList.remove("footer-hidden"),t=t||"Menu",document.getElementById("footer-menu-title").innerText=t,document.getElementById("chatWindow").classList.add("footer-menu"),n.classList.add("open"),n.classList.remove("footer-minimized"),et.footerMenu.isOpen=!0,et.footerMenu.referenceElement=e}}function en(e,t,n,a){if(0<e.length){var o=document.createElement("div"),i=void 0;return t===Be.None||t===Be.Thumbnail?(i=e[0].Image?sn(e):Fa(n,"MultipleChoice")?pn(e):tn(e)).classList.add("text-center"):t===Be.SmallButton?i=nn(e,Ie.SMALL_BUTTON_CARD):t===Be.MediumButton?i=nn(e,Ie.MEDIUM_BUTTON_CARD):t===Be.VisitingCard?i=nn(e,Ie.VISITING_CARD):t===Be.VerticalCard?i=nn(e,Ie.VERTICAL_CARD):t===Be.Hero?console.debug("Card Type: Hero"):t===Be.Image||t===Be.Gif?i=sn(e):t===Be.Video?e&&0<e.length&&(i=ln(e[0])):t===Be.QuickLink?console.debug("Card Type: QuickLink"):t===Be.Location?i=nn(e,Ie.LOCATION_CARD):t===Be.File?i=nn(e,Ie.FILE_CARD):t===Be.FooterMenu?i=nn(e,Ie.FOOTER_MENU,a):t===Be.InteractiveList?i=nn(e,Ie.INTERACTIVE_CARD,a):(console.error("Cannot render card"),console.error("Unknown card type: "+t)),i&&(i.classList.add("mt-1"),o.appendChild(i)),o}}function tn(e){var n=document.createElement("div");n.classList.add("card-thumbnail");var a=0;if(e&&e.length&&e.forEach(function(e){if(e){a++;var t=on(e.Title,e.Options.tap);n.appendChild(t),10<a&&t.classList.add("extra-option")}}),10<a){n.classList.add("show-less");var t=lo(Ie.SHOW_MORE_BUTTON);t.addEventListener("click",function(){n.classList.remove("show-less")}),n.appendChild(t)}return n}function nn(n,a,t){var o=document.createElement("div"),i=0,r=10,e=lo(a),s=e.getAttribute("data-max-cards");s&&(r=parseInt(s,10))<=0&&(r=10),n&&n.length&&n.forEach(function(e){if(e){var t=rn(e,a,++i,n.length);o.appendChild(t),r<i&&t.classList.add("extra-option")}});var l=e.getAttribute("data-container");switch(l||(l=""),l){case"CarouselContainer":if(o.classList.add("custom-carousel"),n.length<=1){var d=JSON.parse(JSON.stringify(Qe));d.arrows=!1,d.autoplay=!1,d.dots=!1,$(o).slick(d)}else $(o).slick(Qe);$(o).slick("setPosition");break;case"FooterMenu":o.classList.add("interactive-menu-options"),o.classList.add("d-none"),et.footerMenu.contentElement.innerHTML="",et.footerMenu.contentElement.appendChild(o),et.footerMenu.hidden=!1,et.footerMenu.container.classList.remove("footer-hidden"),Xt(et.footerMenu.contentElement,t);var c=document.createElement("div");o=c;break;case"InteractiveMenu":o.classList.add("interactive-menu-options"),o.classList.add("d-none");var u=document.createElement("div"),p={};p.Title=t||"Menu",p.Image="icon:bars",p.Options=[];var f=rn(p,Ie.SMALL_BUTTON_CARD,1,1);f.addEventListener("click",function(e){Xt(u,t)}),u.appendChild(f),u.appendChild(o),o=u;break;default:if(o.classList.add("card-thumbnail"),r<i){o.classList.add("show-less");var m=lo(Ie.SHOW_MORE_BUTTON);m.addEventListener("click",function(){o.classList.remove("show-less")}),o.appendChild(m)}}return o}function an(e,t){var n=document.createElement("div");return e=oa(e),n.textContent=e,n.classList.add("option-pill"),t&&(n.classList.add("pointer"),n.addEventListener("click",function(){Bt(t,e)})),n}function on(e,t){var n=an(e,t),a=document.createElement("div");return a.classList.add("option-pill-container"),a.appendChild(n),a}function rn(n,e,t,a){var o=lo(e);if(o.querySelectorAll("[data-card-title]").forEach(function(e){e&&n.Title&&(e.textContent=n.Title)}),o.querySelectorAll("[data-card-subtitle]").forEach(function(e){e&&n.SubTitle&&(e.textContent=n.SubTitle)}),n.Coordinates){var i=o.querySelector("[data-card-coordinates]");if(i||o.hasAttribute("data-card-coordinates")&&(i=o),i){var r="https://www.google.com/maps?q="+n.Coordinates.Item1+","+n.Coordinates.Item2;i.addEventListener("click",function(){window.open(r,"_blank")})}}o.querySelectorAll("[data-card-fileurl]").forEach(function(e){e&&n.FileUrl&&e.addEventListener("click",function(){window.open(n.FileUrl,"_blank")})}),o.querySelectorAll("[data-card-description]").forEach(function(e){e&&n.Description&&(e.innerHTML=n.Description)});var s=o.querySelector("[data-card-tapbutton]");s||o.hasAttribute("data-card-tapbutton")&&(s=o);var l=Ua(n.Image);if(l)o.querySelectorAll("[data-card-icon-container]").forEach(function(e){e&&(e.firstChild?e.insertBefore(l,e.firstChild):e.appendChild(l))});else if(n.Image){o.querySelectorAll("[data-card-image]").forEach(function(e){e&&(e.src=n.Image)})}var d=Object.keys(n.Options);if(s&&n.Options&&0<d.length){var c=n.Options.tap;c||(c=n.Options[d[0]]),s.addEventListener("click",function(){Bt(c,n.Title)})}var u=o.querySelector("[data-card-add-btns]");(u&&n.Options&&Object.keys(n.Options).forEach(function(e){switch(e){case"Open":break;default:var t=lo(Ie.CARD_BUTTON);t&&(t.textContent=e,t.addEventListener("click",function(){Bt(n.Options[e],e)}),u.appendChild(t))}}),a&&1<a)&&o.querySelectorAll("[data-card-slide-number]").forEach(function(e){e&&(e.textContent=t+"/"+a)});return o.querySelectorAll("[data-marked-content]").forEach(function(e){e&&e.innerHTML&&(e.innerHTML=marked(e.innerHTML))}),o}function sn(f){console.log(f);var m=document.createElement("div");if(f&&0<f.length){var g=1;f.forEach(function(t){var e=document.createElement("div"),n=document.createElement("div");n.classList.add("img-container");var a=document.createElement("img"),o=document.createElement("div"),i=document.createElement("div"),r=document.createElement("div"),s=null,l=document.createElement("div"),d=document.createElement("span");if(d.textContent=g+"/"+f.length,a.src=t.Image,a.setAttribute("data-index",g),a.alt=t.Title,a.classList.add("custom-carousel-image","loading","pointer"),a.addEventListener("load",function(){a.classList.remove("loading")}),a.addEventListener("error",function(){vt({message:"Image not found: "+t.Image},!1)}),t.Options){var c=[],u=!1;if(Object.keys(t.Options).forEach(function(e){switch(e){case"Open":a.addEventListener("click",function(e){var t=e.srcElement,n={};n.currentSlideNumber=t.getAttribute("data-index"),n.slides=[],f.forEach(function(e){if(e.Options.Open){var t={imageUrl:e.Options.Open,caption:e.Title};n.slides.push(t)}}),pa(Fe.FullScreenImage,n)}),u=!0;break;default:c.push({title:e,value:t.Options[e]})}}),0<c.length){if(!u){var p=c[0];a.addEventListener("click",function(){Bt(p.value,p.title)})}(s=document.createElement("div")).classList.add("text-center"),c.forEach(function(e){return s.appendChild(an(e.title,e.value))})}}o.textContent=t.Title,i.textContent=t.SubTitle,r.textContent=t.Description,e.classList.add("card-border"),o.classList.add("text-center"),o.classList.add("data-title"),i.classList.add("text-center"),i.classList.add("data-subtitle"),r.classList.add("text-center"),d.classList.add("text-center"),l.classList.add("text-center","card-index","primary-border"),l.appendChild(d),l.style.height=l.style.width,o.textContent&&e.appendChild(ra([],o)),n.appendChild(a),e.appendChild(n),1<f.length&&n.appendChild(l),i.textContent&&e.appendChild(ra([],i)),r.textContent&&e.appendChild(ra([],r)),s&&e.appendChild(ra([],s)),g++,m.appendChild(e)})}if(m.classList.add("custom-carousel"),f.length<=1){var e=JSON.parse(JSON.stringify(Qe));e.arrows=!1,e.autoplay=!1,e.dots=!1,$(m).slick(e)}else $(m).slick(Qe);return $(m).slick("setPosition"),m}function ln(t){if(t&&Un(t.Video))try{return dn(new URL(t.Video).searchParams.get("v"))}catch(e){console.error("[Kenyt.AI] Error rendering Youtube Video: "+t.Video),console.error(e)}return null}function dn(e){var t=document.createElement("iframe");return t.src="https://www.youtube-nocookie.com/embed/"+e,t.frameBorder=0,t.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",t.allowFullscreen="allowFullscreen",t}function cn(e){var n=lo(Ie.OTP_FORM),a=n.querySelector("[data-input-field]"),o=n.querySelector("[data-submit]").querySelector("span"),t=n.querySelector("[data-mobile-number]"),i=n.querySelector("[data-error-description]"),r=n.querySelector("[data-change-mobile-number]"),s=n.querySelector("form");return t.textContent=e||"your mobile",a.pattern=he.source,a.addEventListener("change",function(){i.textContent=""}),r.addEventListener("click",function(){var e=n.parentElement,t=Rn(un());n.remove(),e.appendChild(t)}),s.addEventListener("submit",function(e){e.preventDefault();var t=a.value;i.textContent="",o.classList.remove("fa-paper-plane"),o.classList.add("fa-spin","fa-spinner"),he.test(t)?(console.log("OTP Validated"),Bt(t,t,!1,!1,!1),n.remove()):(console.warn("OTP Invalid"),i.textContent="The OTP you entered is invalid, try again")}),n}function un(){var t=lo(Ie.PHONE_NUMBER_FORM),n=t.querySelector("[data-input-field]"),a=t.querySelector("[data-error-description]"),e=t.querySelector("form");return window.intlTelInput(n,{geoIpLookup:function(e){e("IN")},hiddenInput:"full_number",initialCountry:"auto",placeholderNumberType:"MOBILE",separateDialCode:!0,utilsScript:ue}),n.addEventListener("change",function(){a.textContent=""}),e.addEventListener("submit",function(e){e.preventDefault(),a.textContent="",n.value?(Bt(""+de+n.value,n.value,!1,!1,!1),t.remove()):a.textContent="Please enter a valid mobile number"}),t}function pn(e){var t=document.createElement("div");t.classList.add("multiplechoices");var a=document.createElement("div");t.appendChild(a);var o=document.createElement("button");o.textContent=oa("None of the above")+" ",o.classList.add("btn","btn-success","submit","mt-2");var n=document.createElement("span");return n.classList.add("fa","fa-send"),o.appendChild(n),o.addEventListener("click",function(){gn(a)}),t.appendChild(o),e&&e.length&&e.forEach(function(e){if(e){var t=document.createElement("div");t.textContent=e.Title,t.classList.add("option-pill"),e.Options.tap&&(t.setAttribute("content",e.Options.tap),t.classList.add("pointer"),t.addEventListener("click",function(){t.classList.toggle("isSelected"),mn(o,a)}));var n=document.createElement("div");n.classList.add("option-pill-container"),n.appendChild(t),a.appendChild(n)}}),t}function fn(e){var t=[],n=[];if(e&&e.children)for(var a=e.children,o=0;o<a.length;o++){var i=a[o].children[0];i.classList.contains("isSelected")&&(t.push(i.getAttribute("content")),n.push(i.textContent))}var r={};return r.selected=t.join(),r.display=n.join(),r}function mn(e,t){var n=fn(t);e&&n&&(n.selected?e.textContent=oa("Submit")+" ":e.textContent=oa("None of the above")+" ")}function gn(e){var t=fn(e);t.selected?Bt(t.selected,t.display):Bt("None of the above",oa("None of the above"))}function vn(e){e.which===h||e.keyCode===h?e.target.value&&(e.preventDefault(),hn()):wo(e.target)}function hn(){var e=A.value;e&&(it=!1,Bt(e,e),A.value=""),wo(A)}function yn(e){var t=document.createElement("form");t.setAttribute("id",e.OrderId),t.setAttribute("class","option-pill pointer"),t.setAttribute("action","javascript:onRazorpayPaymentSuccess("+e.OrderId+")");var n=document.createElement("script");return n.setAttribute("src","https://checkout.razorpay.com/v1/checkout.js"),n.setAttribute("data-key",e.RazorpayKeyId),n.setAttribute("data-amount",e.Amount),n.setAttribute("data-currency",e.Currency),n.setAttribute("data-order_id",e.OrderId),n.setAttribute("data-buttontext",e.ButtonText),n.setAttribute("data-name",e.Name),n.setAttribute("data-description",e.Description),n.setAttribute("data-prefill.name",e.LeadName),n.setAttribute("data-prefill.email",e.LeadEmail),n.setAttribute("data-prefill.contact",e.LeadPhone),n.setAttribute("data-theme.color",Ln()),n.addEventListener("load",function(){this.nextElementSibling.click()}),t.appendChild(n),t}function onRazorpayPaymentSuccess(e){for(var t={},n=e.getElementsByTagName("input"),a=0;a<n.length;a++){var o=n[a],i=o.getAttribute("name"),r=o.getAttribute("value");i&&r&&(t[i]=r)}sa(e),Bt("Kcomplete paymenttransaction",null,!1,!1,!1,t)}function En(e){if(L){var t=document.createElement("div");t.classList.add("col-12"),ze?ze=!1:t.classList.add("mt-2");for(var n=arguments.length,a=Array(1<n?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];a.forEach(function(e){t.classList.add(e)}),t.appendChild(e),Cn(t),L.appendChild(t),window.setTimeout(function(){ha(M)},100)}}function Cn(e){To.setFittingClassByText(e)}function Tn(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];console.debug("Applying the following window configuration"),console.debug(e);var a=[],o=wa(),i="py-1";if(e){if(Un(e.FontFamily)&&a.push({elementSelector:"#chatWindow",properties:[{property:"font-family",value:"'"+e.FontFamily+"'"}]}),Un(e.BotPosition)&&pa(Fe.UpdateBotPosition,e.BotPosition),Un(e.FrameColor)){var r=Co.getThemeSettings(e.FrameColor,e.FrameColorGradient);if(r){var s=Co.getThemeSettings("#ffffff","#ffffff");r.backgroundColor?b.style.backgroundColor=r.backgroundColor:b.style.backgroundImage=r.backgroundGradient,b.style.color=r.textColor,k.style.color=r.textColor,O.style.color=r.textColor,A.style.borderColor=r.color,O.style.backgroundColor=r.color,k.style.backgroundColor=r.color,pa(Fe.UpdateChatBubbleColor,r.color),pa(Fe.TextColor,r.textColor),a.push(),a.push({elementSelector:".option-pill:hover",properties:[{property:"color",value:""+r.buttonColorHover,override:!0},{property:"border-color",value:""+r.buttonBackgroundColorHover,override:!0},{property:"background-color",value:""+r.buttonBackgroundColorHover,override:!0}]},{elementSelector:".option-pill.isSelected",properties:[{property:"color",value:""+r.buttonColorHover,override:!0},{property:"border-color",value:""+r.buttonBackgroundColorHover,override:!0},{property:"background-color",value:""+r.buttonBackgroundColorHover,override:!0}]},{elementSelector:".option-pill",properties:[{property:"color",value:""+r.buttonColor,override:!0},{property:"border-color",value:""+r.buttonBorderColor,override:!0},{property:"background-color",value:""+r.buttonBackgroundColor,override:!0}]},{elementSelector:".bg-accent",properties:[{property:"background-image",value:""+r.backgroundGradient,override:!0}]},{elementSelector:".text-accent",properties:[{property:"color",value:""+s.textColor,override:!0}]},{elementSelector:".bot-chat-bubble",properties:[{property:"color",value:s.textColor+" !important"}]},{elementSelector:".interactivelist-card:hover",properties:[{property:"color",value:""+r.buttonColorHover,override:!0},{property:"border-color",value:""+r.colorTo,override:!0},{property:"background-color",value:""+r.colorTo,override:!0}]},{elementSelector:".primary-border",properties:[{property:"border-color",value:r.color+" !important"}]},{elementSelector:".primary-background",properties:[{property:"background-color",value:r.color+" !important"}]},{elementSelector:".primary-color",properties:[{property:"color",value:r.color+" !important"}]},{elementSelector:".primary-text",properties:[{property:"color",value:r.textColor+" !important"}]})}}if(Un(e.EnableSpeech)&&window.hasOwnProperty("webkitSpeechRecognition")&&(Fa(e.EnableSpeech,"true")?la(N):sa(N)),Un(e.UserPersona)&&(t&&(e.UserPersona=bn(e.UserPersona)),Ba("user",e.UserPersona,t)),Un(e.BotPersona)&&(t&&(e.BotPersona=bn(e.BotPersona)),Ba("bot",e.BotPersona,t)),Un(e.FontSize)&&(L.style.fontSize=""+e.FontSize),Un(e.HeaderTextColor)&&(x.style.color=e.HeaderTextColor,w.style.color=e.HeaderTextColor),Un(e.HeaderTitle)&&(e.HeaderTitle===pe?(x.innerHTML="&nbsp;",b.classList.contains(i)||b.classList.add(i)):x.textContent=e.HeaderTitle),Un(e.HeaderSubTitle)&&(e.HeaderSubTitle===pe?w.innerHTML="&nbsp;":(w.textContent=e.HeaderSubTitle,b&&e.HeaderTitle!==pe&&b.classList.contains(i)&&b.classList.remove(i))),Un(e.HeaderFontSize)&&(x.style.fontSize=e.HeaderFontSize),!t&&(Fa(e.ShowPoweredBy,"true")?R.classList.remove("d-none"):R.classList.add("d-none"),e.PoweredBy&&e.PoweredBy.Name&&e.PoweredBy.Website)){var l=document.getElementById("brand-link");l&&(R.classList.remove("d-none"),l.setAttribute("href",e.PoweredBy.Website),l.innerText=e.PoweredBy.Name)}if(Un(e.PlaceholderText)&&wn(e.PlaceholderText),Un(e.BackgroundImage)&&An(e.BackgroundImage),Un(e.BackgroundColor)&&In(e.BackgroundColor),Un(e.UserChatBubbleColor)){var d=Co.getThemeSettings(e.UserChatBubbleColor,e.UserChatBubbleColorGradient);d&&a.push({elementSelector:".user-chat-bubble",properties:[{property:"background-color",value:d.color+" !important"},{property:"color",value:d.textColor+" !important"}]})}if(Un(e.AvatarImage)&&(S.src=e.AvatarImage),Un(e.LiveAgentCall)&&Fa(e.LiveAgentCall,"true")&&Fa(e.HideMenuInHeader,"false")&&la(et.headerMenu.container),at&&(e.DesktopMinimizeBotAtStart=e.DesktopMinimizeBotAtStart||"",e.MobileMinimizeBotAtStart=e.MobileMinimizeBotAtStart||"",e.OpenWindowAfterMilliSeconds||(e.OpenWindowAfterMilliSeconds=0),n||(o?((""==e.MobileMinimizeBotAtStart||Fa(e.MobileMinimizeBotAtStart,"false")||0<e.OpenWindowAfterMilliSeconds)&&setTimeout(function(){Nn()},e.OpenWindowAfterMilliSeconds),_a()):(""==e.DesktopMinimizeBotAtStart||Fa(e.DesktopMinimizeBotAtStart,"false")||0<e.OpenWindowAfterMilliSeconds)&&setTimeout(function(){Nn()},e.OpenWindowAfterMilliSeconds))),0<a.length&&Ea(a),Un(e.Languages)){var c=e.Languages.trim().split(",");if(c&&0<c.length){var u=Ia(c);u&&1<=u.length&&(u[0].value,u.forEach(function(e){e.value===ne&&e.value})),ka(u)}}if(e.CustomPanelCss){var p=document.createElement("style");p.innerText=e.CustomPanelCss,document.head.appendChild(p)}}}function bn(e){var t=e;if(Un(e)){var n=e.match(ve);if(n&&0<n.length){var a=n[0],o=a.match(ge);o&&0<o.length&&(t=e.replace(a,o[0]))}}return t}function Sn(e){var t=Co.normalizeColor(e);return t&&Co.getPercievedBrightness(t)>=Co.BRIGHTNESS_THRESHOLD?"#000000ff":e}function xn(e){e&&x&&(x.textContent=e)}function wn(e){e&&A&&(A.placeholder=e)}function Mn(){return U&&U.AvatarImage&&"string"==typeof U.AvatarImage?U.AvatarImage:defaultWindowConfig.AvatarImage}function Ln(){return Un(U.FrameColor)?U.FrameColor:Ye.FrameColor}function An(e){e&&M&&(M.style.backgroundImage="url("+e+")")}function In(e){Un(e)&&(M.style.backgroundColor=e)}function kn(){pa(Fe.ChatWindowClose)}function Nn(){pa(Fe.ChatWindowOpen)}function _n(e,t,n){var a=document.createElement("div"),o=document.createElement("p");return a.classList.add("d-inline-block","px-2","py-2","float-right","user-chat-bubble"),o.textContent=e,a.appendChild(o),n||a.appendChild(va(t)),a}function On(e,t,n,a,o,i){e||(e="");var r=document.createElement("div");if(r.classList.add("d-inline-block","px-2","py-2","bot-chat-bubble"),r.innerHTML=marked(e),Dn(r),t&&0<t.length){var s=en(t,n,a,i);s&&r.appendChild(s),n&&(n!==Be.MediumButton&&n!==Be.VerticalCard||r.classList.add("chat-bubble-fullwidth"),n===Be.File&&r.classList.add("min-width-50"),n===Be.Location&&(r.classList.add("min-width-50"),r.classList.add("chat-bubble-flexible-width")))}if(o){var l=G;if(!l){var d=(Yn()?we.LOCAL:we.PROD)+"/create/bot";W&&W.startsWith(d)&&(l=!0)}if(l&&Z){var c=document.createElement("div");c.classList.add("pointer","intent-edit");var u=(Yn()?we.LOCAL:we.PROD)+"/settings/training?orgid="+Z.OrganizationId+"&botid="+Z.BotId+"&xpath="+o;c.innerHTML='<span class="fa fa-pencil intent-edit-icon"></span>',c.addEventListener("click",function(){var e={url:u,openInSamePage:!1};pa(Fe.NavigateToPage,e)}),r.appendChild(c)}}return r}function Rn(e){return e&&e.classList.add("d-inline-block","px-2","py-2","bot-chat-bubble"),e}function Dn(e){if(e){var t=Array.from(e.querySelectorAll("a"));t&&0<t.length&&t.forEach(function(e){e.target||(e.target="_blank")})}}function Pn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function Bn(e){return e&&"string"==typeof e}function Un(e){return Bn(e)&&0<e.trim().length}function Fn(){return{botName:V,lastConversationId:H,conversationLanguage:ne,timestamp:new Date,botUserWebContext:qe,messages:G?[]:te}}function Hn(){return{conversationId:H,isMinimized:je,menu:et.headerMenu.content,userPersona:Ge,botName:V,expandType:P&&P.getAttribute("data-toggle")||null,timestamp:new Date,pageUrl:W,queryUserDenied:z}}function Vn(){if(ae){var e=window.localStorage.getItem(E);e?(F=e,console.debug("UserId restored from local storage")):console.debug("UserId not found in local storage")}}function qn(e){e&&(e.timestamp&&(e.timestamp=new Date(e.timestamp)),e.lastConversationId&&e.lastConversationId!==H&&(Ra(e.timestamp,new Date)<Ae?(H=e.lastConversationId,pa(Fe.Initialize,H),e.messages&&0<e.messages.length&&(Gn(e.messages),window.setTimeout(function(){ha(M)},0))):(te=[],console.debug("Session timed out, using new conversationID"),qe.SessionCount?qe.SessionCount=qe.SessionCount+1:qe.SessionCount=1)),e.conversationLanguage&&(ne=e.conversationLanguage))}function zn(e){if(e&&e.botName&&e.botName===V){if(e.conversationId&&(H=e.conversationId),e.userPersona&&Ba("user",e.userPersona),e.expandType)P.getAttribute("data-toggle")!==e.expandType&&_a();e.isMinimized||!1===je||Nn(),Zt(e.menu)}}function Gn(e){e.forEach(function(e){if(e.message)if(e.isUserMessage)"user"!==d&&Oa("user",e.messageTimestamp,!0),En(_n(e.displayMessage?e.displayMessage:e.message,e.messageTimestamp,!0)),d="user";else{if(d!==e.message.DisplayName&&Oa(e.DisplayName,e.messageTimestamp),e.customMessage&&e.customMessage.messageType===Ve.Form&&$a(e.customMessage.values)){var t=Ya(e.customMessage.values);t.fields.forEach(function(e){e&&Un(e.validationPattern)&&(e.validationPattern=new RegExp(e.validationPattern))}),d!==e.customMessage.displayName&&Oa(e.customMessage.displayName,e.messageTimestamp),Va(t)}(Ka(e.message)||Un(e.message))&&Jt(e.message,!0),d=e.message.DisplayName}}),0<(te=e||[]).length&&!isNaN(te[te.length-1].id)&&(ot=te[te.length-1].id+1||ot)}function Wn(){if(ae){window.localStorage.setItem(E,F||"");var e=Fn();console.debug("State saved in localStorage"),console.debug(e),window.localStorage.setItem(Y,JSON.stringify(e)),jn()}else console.warn("[Kenyt.AI] Unable to store state, Cookies are disabled")}function jn(){var e=Hn();console.debug("State saved in sessionStorage"),console.debug(e),window.sessionStorage.setItem(J,JSON.stringify(e))}function Kn(){if(ae){var e=window.localStorage.getItem(Y);return e?JSON.parse(e):e}return null}function $n(){if(ae){var e=window.sessionStorage.getItem(J);return e?JSON.parse(e):e}return null}function Jn(){var e=mt("origin")||document.referrer;return e||console.warn("Cannot retrieve parent URL"),e}function Yn(){var e=window.location.href;return 0<=e.indexOf("http://localhost")||e.startsWith("file:///")}function Qn(){return 0<=window.location.href.indexOf("ngrok.io")}function Zn(){if(Yn())return console.debug("AppName set as "+Se),Se;if(Qn()){var e="https://"+window.location.hostname+be;return console.debug("Endpoint set as ngrok url "+e),e}return console.debug("Endpoint set as "+xe),xe}function Xn(e){return e&&"object"===(void 0===e?"undefined":a(e))&&e instanceof Date}function ea(e){e||(console.debug=function(){})}function ta(n,r,t,e){var a=n.tag||"div",s=document.createElement(a);s.classList.add("form");var o=document.createElement("span"),i=document.createElement("p");if(o.classList.add("h6","font-weight-bold"),i.classList.add("m-0"),o.textContent=r.Title||n.title,i.textContent=r.Description||n.description,s.appendChild(aa(["mt-1"],ia(["text-center"],o,i))),r.Slots){var l=r["Appointment Date"];l||(l={}),l.datetimepickersettings||(l.datetimepickersettings={}),l.datetimepickersettings.beforeShowDay=function(e){var t=Eo.getDateKeys(e),n=!1;return t.every(function(e){return!r.Slots[e]||(n=0<r.Slots[e].length,!1)}),[n,""]},r["Appointment Date"]=l;var d=r["Appointment Time"];d||(d={}),d.datatype="dropdown",d.need="Appointment Date",d.beforeShow=function(e){var n=this,t=Eo.getDateKeys(e),a=d.value;t.every(function(e){return!r.Slots[e]||(a=r.Slots[e],!1)}),a||(a="10 AM, 11 AM, 12 PM, 1 PM, 2 PM, 3 PM, 4 PM, 5 PM, 6 PM, 7 PM, 8 PM"),this.inputElementRef.innerHTML="",a.forEach||(a=a.split(",")),a.forEach(function(e){var t=document.createElement("option");t.innerText=e,t.value=e,n.inputElementRef.appendChild(t)})},r["Appointment Time"]=d}var c=void 0;n.fields.forEach(function(a){var e=na(a,r),o=e.colEle;if(o){if(a.inputElementRef=e.inputElementRef,a.inputContainer=e.inputContainer,a.feedbackElementRef=e.feedbackElementRef,a.takeHalfRow&&o.classList.add("col-6"),c)c.appendChild(o),s.appendChild(c),c=null;else{var t=aa(["mt-2"],o);s.appendChild(t),a.takeHalfRow&&(c=t)}if(a.need&&n.fields.forEach(function(e){if(a.need===e.field&&e&&e.inputElementRef){if("datetime"===e.datatype){var t=e.datetimepickersettings.onChangeDateTime;e.datetimepickersettings.onChangeDateTime=function(e){t&&t(e),a.beforeShow&&a.beforeShow(e),la(a.inputContainer)}}else e.inputElementRef.addEventListener("change",function(){la(a.inputContainer)},!1);sa(a.inputContainer)}}),a.addMore){a.extraInputs=a.extraInputs||[];var i=document.createElement("button");i.textContent=" + ",i.classList.add("btn","btn-success","add-more-btn"),i.addEventListener("click",function(e){e.preventDefault();var t=na(a,r),n=aa(["mt-2"],t.colEle);o.parentNode.parentNode.insertBefore(n,o.parentNode.nextSibling),a.extraInputs.push({inputElementRef:t.inputElementRef,feedbackElementRef:t.feedbackElementRef}),4==a.extraInputs.length&&sa(i)}),o.appendChild(i)}}});var u=document.createElement("button");u.textContent="Cancel",u.classList.add("btn","btn-secondary"),e&&u.addEventListener("click",function(){e()});var p=document.createElement("button");p.textContent=" "+oa("Submit")+" ",p.classList.add("btn","btn-success"),e||p.classList.add("mr-2");var f=document.createElement("span");return f.classList.add("fa","fa-send"),p.appendChild(f),n.onSubmit?s.onsubmit=n.onSubmit:t&&p.addEventListener("click",function(e){t(e,n.fields,n.submit,n.submitType)}),e?s.appendChild(aa(["mt-4"],ia(["text-center"],p,u))):s.appendChild(aa(["mt-4"],ia(["text-center"],p))),s}function na(t,n,e){if(n[t.field]){if(n[t.field].value&&(t.value=n[t.field].value),n[t.field].isMandatory&&(t.isMandatory=n[t.field].isMandatory),n[t.field].need&&(t.isMandatory=n[t.field].need),n[t.field].beforeShow&&(t.beforeShow=n[t.field].beforeShow),n[t.field].telSettings)if(t.telSettings)Object.keys(n[t.field].telSettings).forEach(function(e){t.telSettings[e]=n[t.field].telSettings[e]});else t.telSettings=n[t.field].telSettings;if(n[t.field].datetimepickersettings)if(t.datetimepickersettings)Object.keys(n[t.field].datetimepickersettings).forEach(function(e){t.datetimepickersettings[e]=n[t.field].datetimepickersettings[e]});else t.datetimepickersettings=n[t.field].datetimepickersettings;n[t.field].validationPattern&&(t.validationPattern=n[t.field].validationPattern),n[t.field].image&&(t.image=n[t.field].image),n[t.field].imageClass&&(t.imageClass=n[t.field].imageClass)}var a=document.createElement("label"),o=document.createElement("input"),i=document.createElement("div");if(t.dataType&&(t.datatype=t.dataType),"dropdown"===t.datatype){if(o=document.createElement("select"),t.options=t.options||t.value,t.options){t.options.forEach||(t.options=t.options.split(","));var r=document.createElement("option");r.innerText=t.displayName||t.field,r.value="",o.appendChild(r),t.options.forEach(function(e){var t=document.createElement("option");t.innerText=e,t.value=e,o.appendChild(t)})}o.name=t.field}else o.type=t.datatype,t.placeholder?a.innerHTML=t.placeholder:a.textContent=t.displayName||t.field,o.placeholder=t.placeholder||t.displayName||t.field,o.placeholder=oa(o.placeholder),t.value&&(o.value=t.value);t.name&&(o.name=t.name),o.classList.add("form-control"),o.style.fontStyle="inherit",t.readonly&&o.setAttribute("readonly","readonly"),t.min&&(o.min=t.min),t.max&&(o.max=t.max),i.classList.add("invalid-feedback","d-none"),i.textContent=t.errorMessage;var s=void 0,l=void 0;if(t.image){var d=Ua(t.image);if(d){var c="icon-container";t.imageClass&&(c=c+","+t.imageClass),l=ra(["input-container"],ra(c=c.split(","),d),o)}}if(l||(l=ra([],o)),"checkbox"===t.datatype?(o.name=t.field,o.classList.remove("form-control"),(s=ia([],l,a,i)).classList.add("checkbox"),i.style.display="block"):s=t.useLabel?ia([],a,l,i):ia([],l,i),n&&n.Mandatory&&n.Mandatory.includes(t.field)&&(t.isMandatory=!0),"tel"===t.datatype&&t.validationSource===ce){var u="IN";n&&n.CountryCode&&(u=n.CountryCode);var p={geoIpLookup:function(e){e(u)},hiddenInput:"full_number",initialCountry:"auto",placeholderNumberType:"MOBILE",preferredCountries:["in","us"],separateDialCode:!0,utilsScript:ue};if(t.telSettings)Object.keys(t.telSettings).forEach(function(e){p[e]=t.telSettings[e]});o.value||(o.setAttribute("type","number"),o.setAttribute("onkeydown","javascript: return event.keyCode == 69 ? false : true"));var f=window.intlTelInput(o,p);o.style.paddingLeft="85px",i.style.display="block",t.pluginObj=f}return{colEle:s,inputElementRef:o,inputContainer:l,feedbackElementRef:i}}function aa(e){e.push("row");for(var t=arguments.length,n=Array(1<t?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return ra.apply(void 0,[e].concat(n))}function oa(e){var t=e;return e&&dt&&dt[e]&&(t=dt[e]),t}function ia(e){e.push("col");for(var t=arguments.length,n=Array(1<t?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return ra.apply(void 0,[e].concat(n))}function ra(e){var t=document.createElement("div");e.forEach(function(e){return t.classList.add(e)});for(var n=arguments.length,a=Array(1<n?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];return a.forEach(function(e){return t.appendChild(e)}),t}function sa(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(e){e&&!e.classList.contains("d-none")&&e.classList.add("d-none")})}function la(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(e){e&&e.classList.contains("d-none")&&e.classList.remove("d-none")})}function da(e){var t=e.inputElementRef;t&&(t.classList.contains("is-invalid")?Pa(t,"is-invalid","is-valid"):t.classList.add("is-valid")),sa(e.feedbackElementRef)}function ca(e){var t=e.inputElementRef;t&&(t.classList.contains("is-valid")?Pa(t,"is-valid","is-invalid"):t.classList.add("is-invalid")),la(e.feedbackElementRef)}function ua(t){var n=[];return t&&"object"===(void 0===t?"undefined":a(t))&&Object.keys(t).forEach(function(e){n.push(e+"::"+t[e])}),n.join(", ")}function pa(e,t){var n={type:e,value:t||null};window.parent.postMessage(n,"*")}function fa(e,t){var n={type:e,value:t||null};window.parent.postMessage(n,"*");var a=document.querySelector("#kenytInWindow").contentWindow;if(a){var o={type:Fe,value:value};a.postMessage(o,"*")}}function ma(){var e=new Date,t=e.getHours()%12;return 0===t&&(t=12),t+":"+("0"+e.getMinutes()).slice(-2)+" "+(12<=e.getHours()?"PM":"AM")}function va(e){var t=document.createElement("span");return t.classList.add("float-right","text-muted","message-timestamp"),t.innerHTML=e||ma(),t}function ha(e){e&&(e.scrollTop=e.scrollHeight)}function ya(e){je&&(e&&(e=marked(e)),pa(Fe.UnreadMessage,e))}function Ea(e){if(e&&0<e.length){var n="";e.forEach(function(e){var t="";e.properties&&(e.properties.forEach(function(e){t+=e.property+":"+e.value+" "+(e.override?"!important":"")+";"}),n+=e.elementSelector+"{"+t+"}")}),$("<style>"+n+"</style>").appendTo("head")}}function Ca(){tt&&0<tt.length&&(console.debug("Found "+tt.length+" suspended messages, sending to server now..."),tt.forEach(function(e){e.invokeType?i.invoke(e.invokeType,e.botRequest):Ut(e.botRequest,e.viewRef,e.displayText,e.skipHistory)}),tt=[])}function Ta(){var e="__feature_test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}function ba(e){var t=document.querySelector("#errorbar");if(e=e||"Lost connection due to inactivy. ",t){t.innerHTML=e+' <span class="fa fa-spin fa-spinner fa-pulse"></span>';var n=new Date;if(Je&&Je.pageStartAt)10<(n.valueOf()-Je.pageStartAt.valueOf())/1e3?la(t):console.log(e)}}function Sa(){var e=document.querySelector("#errorbar");e&&(sa(e),e.innerHTML="")}function xa(e){if(e&&!st){for(var t=0;t<e.length;t++)e[t].UserId=F,t===e.length-1&&(e[t].EndTime=new Date);i.invoke("TrackingUpdate",F,V,e).done(function(e){e||vt({message:"Tracking update returned false"},!1)}).fail(function(e){vt({message:"Tracking update failed: "+e},!1)}),st=!0}}function wa(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function Ma(e,t,n){return{event_category:e||null,event_label:t||null,value:n||null}}function La(e,t){Un(e)&&(console.debug("Conversation language changed to "+e),ne=e,0<te.length&&(t||Bt("start conversation",null,!1,!0)),gt("event","language_change",Ma("user_interaction",null,e)),O&&(O.textContent=e.substr(0,2).toUpperCase()))}function Aa(e,t){t||(t=!1);var n={UserId:F,ConversationId:H,BotId:Z?Z.BotId:0,LanguageCode:e,PreventHiMessage:t};ee.isConnected?i.invoke("ChangeChatLanguage",n):(console.warn("[Kenyt.AI] Connection not yet initiated, suspending message.."),mo(n,null,!1,!0,"ChangeChatLanguage"),yt())}function Ia(e){var n=[];return e&&0<e.length&&e.forEach(function(t){if(Un(t)){var e=Ne.find(function(e){return e.value===t.trim().toLowerCase()||e.value===t.trim()});e?n.push(e):console.warn("ignoring Unknown language code: "+t)}}),n}function ka(e){var a=document.querySelector("#languageMenu");if(e&&a){for(;a.hasChildNodes();)a.removeChild(a.firstChild);if(e.length<=1)sa(O);else{la(O);var t=document.createElement("h6");t.classList.add("dropdown-header"),t.textContent="Choose language",a.appendChild(t),e.forEach(function(t){var n=document.createElement("button");n.textContent=t.displayText?t.displayText:t.text,n.addEventListener("click",function(){Aa(t.value);var e=Array.from(a.querySelectorAll(".dropdown-item.active"));e&&0<e.length&&e.forEach(function(e){return e.classList.remove("active")}),n.classList.add("active")}),n.classList.add("dropdown-item"),a.appendChild(n)})}}}function Na(e){e.setNewUser&&(console.debug("resetting UserId"),F="",console.debug("resetting ConversationId"),H="",Wn(),Bt("start conversation",null,!1))}function _a(){var e=P.getAttribute("data-toggle"),t=P.querySelector("span");pa(Fe.ToggleFullScreen,e),"maximize"===e?(P.setAttribute("data-toggle","minimize"),t&&Pa(t,"fa-window-maximize","fa-window-minimize")):(P.setAttribute("data-toggle","maximize"),t&&Pa(t,"fa-window-minimize","fa-window-maximize")),Wn()}function Oa(e,t,n){if(Un(e)&&Un(t)){var a=document.createElement("div"),o=document.createElement("span"),i=document.createElement("span");if(o.textContent=e,o.classList.add("persona"),i.textContent=""+t,i.classList.add("timestamp","mx-1"),"user"===e||"bot"===e){var r=document.createElement("img"),s="bot"===e?We:Ge,l="bot"===e?"bot-persona":"user-persona",d=document.createElement("span");"bot"===e?d.classList.add("fa","fa-robot"):d.classList.add("fa","fa-user"),o.textContent=s.name,o.classList.add(l),r.classList.add(l),Un(s.imageUrl)?(r.src=s.imageUrl,d.classList.add("d-none")):r.classList.add("d-none"),r.addEventListener("error",function(){r.classList.add("d-none"),console.warn("Image not found: "+imageUrl)}),15==V&&a.appendChild(d),a.appendChild(r)}a.appendChild(o),a.appendChild(i),a.classList.add("message-sender","px-3","w-100","mt-2"),n&&a.classList.add("text-right"),L.appendChild(a),ze=!0}}function Xn(e){return e&&"object"===(void 0===e?"undefined":a(e))&&e instanceof Date}function Ra(e,t){if(Xn(e)&&Xn(t)){var n=Math.abs(e.valueOf()-t.valueOf());return Math.floor(n/1e3/60)}return NaN}function Da(){pa(Fe.ForceFullHeight)}function Pa(e,t,n){return!!(e&&t&&n&&e.classList.contains(t))&&(e.classList.remove(t),e.classList.add(n),!0)}function Ba(e,t,n){if(Un(e)&&Un(t)){var a=t.match(ge),o=a&&0<a.length?a[0]:null,i=void 0;o&&(t=" "+t.replace(o,"").trim());var r={name:t,imageUrl:o};if(Fa(e,"bot")?(We=r,i="bot-persona"):Fa(e,"user")&&(Ge=r,i="user-persona"),!n&&Un(i)){var s=Array.from(L.querySelectorAll("span."+i));Array.from(L.querySelectorAll("img."+i)).forEach(function(e){Un(r.imageUrl)?(e.src=r.imageUrl,e.classList.remove("d-none")):e.classList.add("d-none")}),s.forEach(function(e){e.textContent=r.name})}}}function Ua(e){var t=null;if(e&&e.startsWith("icon:")){var n=e.substr(5);n&&(t=document.createElement("span")).classList.add("fa","fa-"+n)}return t}function Fa(e,t){return Bn(e)&&Bn(t)&&e.toLowerCase()===t.toLowerCase()}function Ha(e){var t={};if(e)for(var n=e.split(";"),a=0;a<n.length;a++){var o=n[a];if(o){var i=o.split("=");if(1<i.length){var r=i[0].trim(),s=i[1].trim();t[r]=s}}}return t}function Va(e,t,n){if(e){var a=ta(e,t,n=n||At),o=On();o.classList.add("w-95"),o.appendChild(a),En(o),e.fields.forEach(function(e){e.afterAppend&&e.afterAppend()})}else console.warn("Invalid form"),console.warn(e)}function qa(e){var t=[];return e&&(t=JSON.parse(e)),t}function za(e){e.fields.forEach(function(e){e.dataType&&(e.datatype=e.dataType),e.datatype&&("email"===e.datatype?e.validationPattern||(e.validationPattern=_e.EMAIL_VALIIDATION_PATTERN):"tel"===e.datatype?e.validationSource||(e.validationPattern=_e.PHONE_VALIDATION_SOURCE):"url"===e.datatype&&(e.validationSource||(e.validationPattern=_e.URL_VALIIDATION_PATTERN)))}),e.settings?e.settings=JSON.parse(e.settings):e.settings=[]}function Ga(e,t){var n=Ya(e);n.fields.forEach(function(e){e&&Ja(e.validationPattern)&&(e.validationPattern=e.validationPattern.source)}),te.push({id:ot++,isUserMessage:!1,message:" ",messageTimestamp:ma(),displayMessage:null,customMessage:{messageType:Ve.Form,values:n,displayName:t}})}function Wa(){if(L)for(var e=L.childElementCount;1<e;){var t=L.lastElementChild;L.removeChild(t),e-=1}}function ja(){te=[],eo(L),Wn()}function Ka(e){return e&&"object"===(void 0===e?"undefined":a(e))}function $a(e){return Ka(e)&&e instanceof Array}function Ja(e){return Ka(e)&&e instanceof RegExp}function Ya(t){var n=void 0;return $a(t)?(n=[],t.forEach(function(e){n.push(Ya(e))})):Ka(t)?(n={},Object.keys(t).forEach(function(e){n[e]=t[e]})):n=t,n}function Qa(e,t){En(Xa("⛊ You are now chatting with "+(t||e||"Agent")),"text-strip")}function Za(e,t){En(Xa("⛊ "+(t||e||"Agent")+" has left the conversation"),"text-strip")}function Xa(e){var t=document.createElement("span");return t.textContent=e,t}function eo(e){if(e)for(var t=e.lastElementChild;t;)e.removeChild(t),t=e.lastElementChild}function to(){X&&(X.stop(),X.start(),gt("event","Button_Speech_Start",Ma("user_interaction",null,null)))}function no(){Bt("Caller form","Contact Agent",!1,!1,!1)}function ao(){X.stop(),gt("event","Button_Speech_Stop",Ma("user_interaction",null,null))}function oo(e){if(window.speechSynthesis){var t=new SpeechSynthesisUtterance(e);t.lang="en-US",t.pitch=1,t.rate=1,t.volume=1,speechSynthesis.paused&&speechSynthesis.resume(),window.speechSynthesis.speak(t)}}function io(e,t,n){var a=new Date,o=String(a.getDate()+e).padStart(2,"0"),i=String(a.getMonth()+t+1).padStart(2,"0");return a=String(a.getFullYear()+n)+"-"+i+"-"+o}function ro(){window.navigator||(window.navigator={});var e=window.navigator.userAgent.toLowerCase(),t="";t=0<=e.indexOf("windows")?"Windows":0<=e.indexOf("linux")?"Linux":0<=e.indexOf("mac")?"macOS":0<=e.indexOf("blackberry")?"BlackBerry":0<=e.indexOf("android")?"Android":0<=e.indexOf("iphone")||0<=e.indexOf("ipad")?"iOS":"unknown";var n="Desktop";return wa()&&(n="Mobile"),{Browser:window.navigator.browserInfo||"",OperatingSystem:t,Referrer:Ke.pageReferrer||"",Device:n,RawUserAgent:window.navigator.userAgent||"",PageUrl:Jn()||"",PageTitle:Ke.pageTitle||""}}function so(){var e=[{field:"Name",datatype:"text",errorMessage:"please enter a valid name",isMandatory:!1,image:"icon:user"},{field:"Email",datatype:"email",errorMessage:"please enter a valid email address",validationPattern:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,10}|[0-9]{1,5})(\]?)$/,isMandatory:!1,image:"icon:envelope"},{field:"Mobile",datatype:"tel",errorMessage:"please enter a valid phone number",validationSource:ce,isMandatory:!1,image:"icon:phone"}];return{title:oa("Contact Information"),description:oa("Please enter your contact details"),fields:e}}function lo(e){var t=void 0,n=document.querySelector("#"+e);return n&&(t=document.importNode(n.content.firstElementChild,!0)),t}function co(){var e=[{field:"Appointment Date",datatype:"datetime",errorMessage:"please select a valid date",isMandatory:!0,readonly:!0,image:"icon:calendar",datetimepickersettings:{timepicker:!1,format:"d-M-Y",minDate:"-1970/01/1",maxDate:"+1970/06/1",scrollMonth:!1,scrollInput:!1},afterAppend:function(){this.inputElementRef&&$(this.inputElementRef).datetimepicker(this.datetimepickersettings)}},{field:"Appointment Time",datatype:"dropdown",errorMessage:"please select a valid time",isMandatory:!0,value:["10 AM","11 AM","12 PM","1 PM","2 PM","3 PM","4 PM","5 PM","6 PM"],need:"Appointment Date",image:"icon:clock-o"}],t=(new Date).getTimezoneOffset(),n=Math.abs(t);return{title:"Select Appointment Date and Time UTC"+(t=(t<0?"+":"-")+("00"+Math.floor(n/60)).slice(-2)+":"+("00"+n%60).slice(-2)),description:"",fields:e}}function uo(){return{title:"Please upload your file(s)",description:"",fields:[{field:"File",datatype:"file",name:"file",errorMessage:"please select a valid file",isMandatory:!0,addMore:{limit:5}}],tag:"form"}}function po(){return{title:"Address Information",description:"Please enter your address details",fields:[{field:"Address Line 1",datatype:"text",errorMessage:"please enter a valid address",isMandatory:!0},{field:"Address Line 2",datatype:"text",errorMessage:"please enter a valid address",isMandatory:!1},{field:"City",datatype:"text",errorMessage:"Please enter a valid City",isMandatory:!0,takeHalfRow:!0},{field:"State",datatype:"text",errorMessage:"please enter a valid State",isMandatory:!0,takeHalfRow:!0},{field:"Country",datatype:"text",errorMessage:"please enter a valid Country",isMandatory:!0,takeHalfRow:!0},{field:"Zip Code",datatype:"text",errorMessage:"Please enter a valid Zip Code",validationPattern:/^[1-9][0-9]{5}$/,isMandatory:!0,takeHalfRow:!0}],submit:"address form submission",submitType:"values"}}function fo(e,t){var n={EventName:e,EventData:t||null};pa(Fe.CustomEventDispatch,n)}function mo(e,t,n,a,o){tt||(tt=[]),tt.push({botRequest:e,viewRef:t,displayText:n,skipHistory:a,invokeType:o})}function go(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function vo(){return new Date}function ho(e){return("0"+e).slice(-2)}function yo(){var e=document.getElementById("header-content");e.offsetWidth?(x.style.width=e.offsetWidth+"px",x.style.whiteSpace="nowrap"):window.setTimeout(function(){yo()},1e3)}window.dataLayer=window.dataLayer||[],ht(),$(document).ready(function(){gt("event",ye.EVENT_DOCUMENT_READY),fo(He.Load,{botId:V}),console.debug("BotClient: "+V),T=document.querySelector("#chatWindow"),b=document.querySelector("#chatWindowHeader"),S=document.querySelector("#avatarImage"),x=document.querySelector("#headerTitle"),w=document.querySelector("#headerSubTitle"),M=document.querySelector("#chatWindowBody"),A=document.querySelector("#chatInput"),I=document.querySelector("#chatActions"),k=document.querySelector("#sendButton"),N=document.querySelector("#speechButton"),_=document.querySelector("#callButton"),et.headerMenu.container=document.querySelector("#menuContainer"),et.footerMenu.container=document.querySelector("#footer-menu"),et.footerMenu.optionsContainer=document.querySelector("#footer-menu-options"),et.footerMenu.hidden=!0,et.footerMenu.container.addEventListener("click",function(){if(et.footerMenu.container.classList.contains("footer-minimized"))Xt(et.footerMenu.contentElement);else{if(et.footerMenu.container.classList.remove("open"),et.footerMenu.container.classList.add("footer-minimized"),T.classList.remove("footer-menu"),et.footerMenu.isOpen=!1,et.footerMenu.referenceElement){var e=et.footerMenu.optionsContainer.getElementsByClassName("interactive-menu-options");e&&0<e.length&&((e=e[0]).classList.add("d-none"),et.footerMenu.referenceElement.appendChild(e))}et.footerMenu.hidden&&et.footerMenu.container.classList.add("footer-hidden")}}),et.footerMenu.closeElement=document.querySelector("#footer-menu-closed"),et.footerMenu.contentElement=document.querySelector("#footer-menu-content"),O=document.querySelector("#languageButton"),L=document.querySelector("#messageContainer"),R=document.querySelector("#poweredByText"),D=document.querySelector("#chatWindowFooter"),P=document.querySelector("#headerMaximizeMinimizeButton"),B=document.querySelector("#headerCloseButton"),Q=document.querySelector("#stopSpeech"),U={},yo(),W=Jn(),V=mt("botid"),G="1"===mt("test")||0<V.indexOf("-test"),q=mt("userid",W),K=mt("hash"),Ye.AvatarImage=(Yn()?"":"/botapp")+Ye.AvatarImage+V,Ye.backgroundImage&&(Ye.BackgroundImage=(Yn()?"":"/botapp")+Ye.BackgroundImage+V),Tn(Ye),oe=!1,Y=ie+V+"_"+K,J=re+V+"_"+K,te=[],ae=Ta(),ea(rt=Yn()),ae||Yn()||gt("event",ye.EVENT_COOKIES_DISABLED,Ma("browser_info")),Vn();var e=Kn();qe=e&&e.botUserWebContext?e.botUserWebContext:qe,Xe.previousStateLoaded=!1,e?(console.debug("Found previous state, restoring.."),qn(e,!0)):(te=[],console.debug("No previous state found")),Xe.previousStateLoaded=!0;var t=$n();t?(console.debug("Found previous session state, restoring..."),zn(t),at=!1,t.queryUserDenied&&(q=null)):console.debug("No previous session state found");var n=!1;if(te&&0!=te.length){if(t&&t.pageUrl!==W&&(te.forEach(function(e){e.isUserMessage&&(oe=!0)}),oe?n=!1:(n=!0,ja()),W&&!W.includes("?"))){var a=t.pageUrl,o=a.indexOf("?");0<o&&(W+=a.substring(o))}}else n=!0;var i=De+"?botId="+V,p=new XMLHttpRequest;if(p.open("POST",i,!0),p.setRequestHeader("Content-type","application/json"),!j){var r=new URL(window.location.href),s=r.searchParams.keys(),l=!0,d=!(j={}),c=void 0;try{for(var u,f=s[Symbol.iterator]();!(l=(u=f.next()).done);l=!0){var m=u.value,g=m;g.startsWith("context-")&&(g=g.substring(8),j[g]=r.searchParams.get(m))}}catch(e){d=!0,c=e}finally{try{!l&&f.return&&f.return()}finally{if(d)throw c}}}var v,h,y,E={IsTest:G,SessionUserId:F,QueryClientUserId:q,ConversationId:H,ConversationLanguage:ne||"",TimezoneOffsetMinutes:-1*(new Date).getTimezoneOffset(),SourceUrl:W,TriggerAutoMessage:n,ConversationContext:j},C=JSON.stringify(E);p.onload=function(){gt("event",ye.EVENT_LOAD_CHAT_RECEIVED),pt.receivedAt=new Date;var e=!1;try{var t=JSON.parse(p.response);if(t){if(G=t.IsTest,t.OrgBot&&(Z=t.OrgBot,gt("event",ye.EVENT_VALID_BOT_ID)),t.ConversationId&&Rt(t.ConversationId),t.Response&&(Mt(t.Response),gt("event",ye.EVENT_AUTO_MESSAGE_RECEIVED)),t.InitializeConnection&&(e=!0),t.WindowConfiguration){var a={},o=t.WindowConfiguration;o&&Object.keys(o).forEach(function(e){var t=o[e].Value,n=o[e].Key;n in Ye&&(a[n]=t)}),Tn(a)}if(t.QueryUserDetails){var n=document.createElement("div"),i=document.createElement("p");if(i.innerText="Would you like to continue as",n.appendChild(i),t.QueryUserDetails.MaskedEmail){var r=document.createElement("p");r.innerText=t.QueryUserDetails.MaskedEmail,n.appendChild(r)}if(t.QueryUserDetails.MaskedPhone){var s=document.createElement("p");s.innerText=t.QueryUserDetails.MaskedPhone,n.appendChild(s)}var l=document.createElement("div");l.classList.add("card-thumbnail","text-center","mt-1"),n.appendChild(l);var d=document.createElement("div");d.classList.add("option-pill","pointer"),d.innerText="Yes",l.appendChild(d);var c=document.createElement("div");c.classList.add("option-pill","pointer"),c.innerText="No",l.appendChild(c),d.addEventListener("click",function(e){t&&t.QueryUserId&&Ot(t.QueryUserId),window.setTimeout(function(){Bt("",null,!0,!0)},0),d.disabled=!0,c.disabled=!0}),c.addEventListener("click",function(e){z=!0,t&&t.SessionUserId&&Ot(t.SessionUserId),window.setTimeout(function(){Bt("",null,!0,!0)},0),d.disabled=!0,c.disabled=!0});var u=On();u.classList.add("w-95"),u.appendChild(n),En(u)}else t.SessionUserId&&Ot(t.SessionUserId);t.LanguageSettings&&Dt(t.LanguageSettings)}}catch(e){e.message="load chatbot error:: "+(e&&e.message||""),vt(e)}(e&&yt(),pt.requestedAt&&pt.receivedAt)&&((pt.receivedAt.valueOf()-pt.requestedAt.valueOf())/1e3<Le&&gt("event",ye.EVENT_LOAD_CHAT_INTIME))},gt("event",ye.EVENT_LOAD_CHAT_REQUESTED),pt.requestedAt=new Date,p.send(C),gt("event",n?ye.EVENT_AUTO_MESSAGE_REQUESTED:ye.EVENT_AUTO_MESSAGE_SKIPPED),(window.hasOwnProperty("webkitSpeechRecognition")||window.hasOwnProperty("SpeechRecognition"))&&((X=new(window.webkitSpeechRecognition||window.SpeechRecognition)).lang="en-IN",X.onerror=function(e){"no-speech"===e.error?console.warn("No speech detected"):(vt({message:"Speech recognition error: "+e},!1),console.warn(e))},X.onstart=function(e){console.debug("Speech recognition started"),wn("Listening... say something"),N.classList.add("blink")},X.onend=function(e){console.debug("Speech Recognition ended"),wn(U.PlaceholderText||Ye.PlaceholderText),N.classList.remove("blink")},X.onnomatch=function(e){console.warn("Failed to recognize speech")},X.onresult=function(e){console.debug("Speech recognition result"),console.debug(e);var t=e.results[0][0].transcript;console.debug("Recognized Speech: '"+t+"'"),Un(t)&&(console.debug(t),it=!0,Bt(t,t))},window.speechSynthesis&&(window.speechSynthesis.onerror=function(e){console.error("Error in speech synthesis"),console.error(e),vt({message:"Text to speech error: "+e},!1)})),window.navigator&&(window.navigator.browserInfo=(h=navigator.userAgent,y=h.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(y[1])?"IE "+((v=/\brv[ :]+(\d+)/g.exec(h)||[])[1]||""):"Chrome"===y[1]&&null!=(v=h.match(/\b(OPR|Edge)\/(\d+)/))?v.slice(1).join(" ").replace("OPR","Opera"):(y=y[2]?[y[1],y[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(v=h.match(/version\/(\d+)/i))&&y.splice(1,1,v[1]),y.join(" ")))),Ct(),ee={isConnected:!1,tryingToReconnect:!1},wa()&&la(P)});var Eo=function(){function r(e){var t=e.getMonth()+1,n=e.getDate();return[e.getFullYear(),(9<t?"":"0")+t,(9<n?"":"0")+n].join("-")}return{getDateKeys:function(e){var t,n,a,o,i=[];return e&&(r(e)==r(new Date)?i.push("today"):(i.push(r(e)),i.push((a=(n=e).getMonth()+1,o=n.getDate(),["****",(9<a?"":"0")+a,(9<o?"":"0")+o].join("-"))),i.push(["****","**",(9<(t=e.getDate())?"":"0")+t].join("-")),i.push(e.getDay()))),i}}}(),Co=function(){var i=150,r="#000000ff",s="#ffffffff",l=/^#[0-9a-f]{6}$/i,d=/^#[0-9a-f]{6}$/i,c=/^#[0-9a-f]{8}$/i,u=/^rgb\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*\)$/i,p=/^rgba\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*(\d|\d\.\d+)\s*\)$/i;function f(e){if(!e)return e;var t={red:0,green:0,blue:0,alpha:1};if(e=e.trim(),c.test(e))t.red=v(e.substr(1,2)),t.green=v(e.substr(3,2)),t.blue=v(e.substr(5,2)),t.alpha=v(e.substr(7,2));else if(l.test(e))t.red=v(e.substr(1,2)),t.green=v(e.substr(3,2)),t.blue=v(e.substr(5,2));else if(d.test(e))t.red=v(e[1]+"{"+e[1]),t.green=v(e[2]+"{"+e[2]),t.blue=v(e[3]+"{"+e[3]);else if(p.test(e)){var n=h(e," ",""),a=(n=n.substring(n.indexOf("(")+1,n.lastIndexOf(")"))).split(",");t.red=Math.min(parseInt(a[0]),255),t.green=Math.min(parseInt(a[1]),255),t.blue=Math.min(parseInt(a[2]),255),t.alpha=Math.min(parseFloat(a[3]),1)}else if(u.test(e)){var o=h(e," ",""),i=(o=o.substring(o.indexOf("(")+1,o.lastIndexOf(")"))).split(",");t.red=Math.min(parseInt(i[0]),255),t.green=Math.min(parseInt(i[1]),255),t.blue=Math.min(parseInt(i[2]),255),t.alpha=1}else console.warn("color format unsupported: "+e),t=null;return t}function m(e){return e?Math.floor(Math.sqrt(.241*e.red*e.red+.691*e.green*e.green+.068*e.blue*e.blue)):0}function g(e){if(!e)return e;return"#"+y(t(e.red),"0",2)+y(t(e.green),"0",2)+y(t(e.blue),"0",2)+y(t(e.alpha),"0",2)}function t(e){return e.toString(16)}function v(e){return parseInt("0x"+e)}function h(e,t,n){if(e&&t)for(n||(n="");0<=e.indexOf(t);)e=e.replace(t,n);return e}function y(e,t,n){return e&&t&&n&&(e=e.padStart(n,t[0])),e}function E(e,t){3==(e=e.replace(/^\s*#|\s*$/g,"")).length&&(e=e.replace(/(.)/g,"$1$1"));var n=parseInt(e.substr(0,2),16),a=parseInt(e.substr(2,2),16),o=parseInt(e.substr(4,2),16),i="#"+y((0|256+n+(256-n)*t/100).toString(16).substr(1),"0",2);return i+=y((0|256+a+(256-a)*t/100).toString(16).substr(1),"0",2),i+=y((0|256+o+(256-o)*t/100).toString(16).substr(1),"0",2)}return{getThemeSettings:function(e,t){var n=null,a=g(f(e));if(a){a=a.substr(0,7),(n={}).color=a;var o=g(f(t));n.backgroundColor=o?(o=o.substr(0,7))===a?(n.colorFrom=a,n.colorTo=o,n.backgroundGradient="linear-gradient(90deg,"+n.colorFrom+","+n.colorTo+")",n.backgroundGradientRev="linear-gradient(270deg,"+n.colorFrom+","+n.colorTo+")",a):(n.colorFrom=a,n.colorTo=o,n.backgroundGradient="linear-gradient(90deg,"+n.colorFrom+","+n.colorTo+")",n.backgroundGradientRev="linear-gradient(270deg,"+n.colorFrom+","+n.colorTo+")",""):(n.colorFrom=E(a,-30),n.colorTo=E(a,30),n.backgroundGradient="linear-gradient(90deg,"+n.colorFrom+","+n.colorTo+")",n.backgroundGradientRev="linear-gradient(270deg,"+n.colorFrom+","+n.colorTo+")",""),n.percievedBrightness=m(f(n.colorFrom)),n.percievedBrightness1=m(f(n.color)),n.percievedBrightness2=m(f(n.colorTo)),n.textColor=n.percievedBrightness<=i?s:r,n.buttonColor=(n.percievedBrightness,r),n.buttonBorderColor=(n.percievedBrightness,a),n.buttonBackgroundColor=(n.percievedBrightness,s),n.buttonColorHover=(n.percievedBrightness,s),n.buttonBackgroundColorHover=n.percievedBrightness<=i?a:"#525252"}return n},getTextColorForBackground:function(e){var t="#000000ff";if(console.debug("Background Color: "+e),!e)return t;var n=f(e);return console.debug("Normalized background color: "),console.debug(n),n&&m(n)<=150?"#ffffffff":t},setAlpha:function(e,t){if(!e||isNaN(t))return e;t=Math.floor(255*Math.min(Math.max(0,t),1));var n=f(e);return n.alpha=t,g(n)},normalizeColor:f,getPercievedBrightness:m,BRIGHTNESS_THRESHOLD:i}}(),To={isMessageFitting:function(e,t,n){var a=!0,o=e.cloneNode(!0);if(o.getElementsByClassName(t)){var i=document.getElementById("roughMessageContainer");i.appendChild(o);var r=o.getElementsByClassName("option-pill-container");Array.prototype.forEach.call(r,function(e){var t=e.firstElementChild;t.scrollHeight>t.clientHeight&&(a=!1)}),a||(r=e.getElementsByClassName("option-pill-container"),Array.prototype.forEach.call(r,function(e){e.classList.remove(t),e.classList.add(n)})),i.removeChild(o)}return a},setFittingClassByText:function(e){var t=e.getElementsByClassName("option-pill-container");if(t&&t.length){var i=[];Array.prototype.forEach.call(t,function(e){if(e.textContent){for(var t=0,n=0;n<e.textContent.length;n++){var a=e.textContent.charAt(n);" "==a?t+=4:a==a.toLowerCase()?t+=9:t+=12}var o=1;t<=90?o=3:t<=160&&(o=2),i.push(o)}else i.push(-1)});for(var n=3,a=0;a<i.length;){for(var o=i[a],r=i[a],s=!0,l=1;l<o;l++)a+l<i.length?i[a+l]>=r||(s=!1):s&&0<a&&r==n?(o=l,l+=i[a]):s=!1;if(s){var d="option-pill-"+r;for(l=0;l<o;l++)t[a+l].classList.add(d);a+=o,r<n&&(n=r)}else i[a]=i[a]-1}}}};function bo(e){e.Command&&So({Type:"UserChat",Command:"StartCall",Data:e})}function So(e){pa(Fe.MediaStreamingCommand,e)}function xo(e){var t={UserId:F||"",ConversationId:H||"",BotClientName:V||""};i.invoke("OnMediaSignal",e,t).done().fail(function(e){console.error("Message sending failed: "+e)})}function wo(e){e.style.height="5px",e.style.height=e.scrollHeight+"px",e.style.borderRadius="5px"}